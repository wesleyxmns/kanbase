{"version":3,"file":"kanbase.es.js","sources":["../src/lib/utils/utils.js","../src/lib/store/use-kanban-store.js","../src/lib/hooks/use-kanban.js","../src/lib/hooks/use-kanban-dnd.js","../src/lib/utils/filter-evaluator.js","../src/lib/utils/cn.js","../src/lib/components/default/default-card.js","../src/lib/components/default/default-column-empty.js","../src/lib/components/default/default-column-header.js","../src/components/ui/dialog.js","../src/components/ui/button.js","../src/lib/components/default/default-edit-form.js","../src/lib/components/default/default-card-view.js","../src/lib/components/filter-chips.js","../src/lib/hooks/use-kanban-column.js","../src/lib/components/add-card-button.js","../src/lib/components/kanban-card.js","../src/lib/components/kanban-column.js","../src/components/ui/sheet.js","../src/lib/components/filter-group.js","../src/lib/utils/data-discovery.js","../src/lib/components/kanban-filter-drawer.js","../src/lib/components/default/default-add-card-form.js","../src/lib/components/default/default-edit-column-form.js","../src/lib/components/kanboom-board.js","../src/lib/store/selectors.js","../src/lib/benchmark/fps-monitor.js"],"sourcesContent":["import { clsx } from \"clsx\";\nimport { twMerge } from \"tailwind-merge\";\nexport function cn(...inputs) {\n    return twMerge(clsx(inputs));\n}\n","import { create } from 'zustand';\nimport { devtools } from 'zustand/middleware';\nconst generateId = () => `${Date.now()}-${Math.random().toString(36).substr(2, 9)}`;\nexport const useKanbanStore = create()(devtools((set) => ({\n    cards: {},\n    columns: {},\n    columnOrder: [],\n    config: {},\n    activeId: null,\n    viewingCardId: null,\n    editingCardId: null,\n    addingCardInColumnId: null,\n    editingColumnId: null,\n    // Initial Filter State\n    filters: {\n        searchQuery: '',\n        groups: [],\n        quickFilters: []\n    },\n    // === CARDS ===\n    addCard: (columnId, cardData) => {\n        const cardId = generateId();\n        const newCard = {\n            id: cardId,\n            ...cardData,\n        };\n        set((state) => {\n            const column = state.columns[columnId];\n            if (!column)\n                return state;\n            return {\n                cards: { ...state.cards, [cardId]: newCard },\n                columns: {\n                    ...state.columns,\n                    [columnId]: {\n                        ...column,\n                        cardIds: [...column.cardIds, cardId],\n                    },\n                },\n            };\n        });\n        return cardId;\n    },\n    updateCard: (cardId, updates) => set((state) => {\n        const card = state.cards[cardId];\n        if (!card)\n            return state;\n        return {\n            cards: {\n                ...state.cards,\n                [cardId]: { ...card, ...updates },\n            },\n        };\n    }),\n    deleteCard: (cardId) => set((state) => {\n        const { [cardId]: deletedCard, ...remainingCards } = state.cards;\n        const updatedColumns = { ...state.columns };\n        Object.keys(updatedColumns).forEach((colId) => {\n            updatedColumns[colId] = {\n                ...updatedColumns[colId],\n                cardIds: updatedColumns[colId].cardIds.filter((id) => id !== cardId),\n            };\n        });\n        return {\n            cards: remainingCards,\n            columns: updatedColumns,\n        };\n    }),\n    duplicateCard: (cardId) => {\n        let newCardId = '';\n        set((state) => {\n            const card = state.cards[cardId];\n            if (!card)\n                return state;\n            const columnId = Object.keys(state.columns).find((colId) => state.columns[colId].cardIds.includes(cardId));\n            if (!columnId)\n                return state;\n            newCardId = generateId();\n            const duplicatedCard = {\n                ...card,\n                id: newCardId,\n                title: `${card.title} (copy)`,\n            };\n            const column = state.columns[columnId];\n            const cardIndex = column.cardIds.indexOf(cardId);\n            const newCardIds = [...column.cardIds];\n            newCardIds.splice(cardIndex + 1, 0, newCardId);\n            return {\n                cards: { ...state.cards, [newCardId]: duplicatedCard },\n                columns: {\n                    ...state.columns,\n                    [columnId]: {\n                        ...column,\n                        cardIds: newCardIds,\n                    },\n                },\n            };\n        });\n        return newCardId;\n    },\n    // === COLUMNS ===\n    addColumn: (columnData, position) => {\n        const columnId = generateId();\n        const newColumn = {\n            id: columnId,\n            ...columnData,\n            cardIds: [],\n        };\n        set((state) => {\n            const newColumnOrder = [...state.columnOrder];\n            const insertPosition = position ?? newColumnOrder.length;\n            newColumnOrder.splice(insertPosition, 0, columnId);\n            return {\n                columns: { ...state.columns, [columnId]: newColumn },\n                columnOrder: newColumnOrder,\n            };\n        });\n        return columnId;\n    },\n    updateColumn: (columnId, updates) => set((state) => {\n        const column = state.columns[columnId];\n        if (!column)\n            return state;\n        return {\n            columns: {\n                ...state.columns,\n                [columnId]: { ...column, ...updates },\n            },\n        };\n    }),\n    deleteColumn: (columnId, moveCardsTo) => set((state) => {\n        const column = state.columns[columnId];\n        if (!column)\n            return state;\n        const { [columnId]: deletedColumn, ...remainingColumns } = state.columns;\n        const newColumnOrder = state.columnOrder.filter((id) => id !== columnId);\n        let updatedCards = { ...state.cards };\n        let updatedColumns = { ...remainingColumns };\n        if (moveCardsTo && updatedColumns[moveCardsTo]) {\n            // Explicit move requested\n            const targetCol = updatedColumns[moveCardsTo];\n            updatedColumns[moveCardsTo] = {\n                ...targetCol,\n                cardIds: [...targetCol.cardIds, ...column.cardIds],\n            };\n            // Update local card previousColumnId just in case\n            column.cardIds.forEach(cardId => {\n                if (updatedCards[cardId]) {\n                    updatedCards[cardId] = { ...updatedCards[cardId], previousColumnId: columnId };\n                }\n            });\n        }\n        else {\n            // SAFE DELETE: Return cards to previous column or first available\n            const firstColumnId = newColumnOrder.length > 0 ? newColumnOrder[0] : null;\n            column.cardIds.forEach((cardId) => {\n                const card = updatedCards[cardId];\n                if (!card)\n                    return;\n                const targetColId = (card.previousColumnId && updatedColumns[card.previousColumnId])\n                    ? card.previousColumnId\n                    : firstColumnId;\n                if (targetColId && updatedColumns[targetColId]) {\n                    const targetCol = updatedColumns[targetColId];\n                    updatedColumns[targetColId] = {\n                        ...targetCol,\n                        cardIds: [...targetCol.cardIds, cardId]\n                    };\n                    // Keep the existing provenance? Or update?\n                    // Attempts to point to the deleted column are useless since it's gone.\n                    // Better to leave it pointing to the *original* source if possible, \n                    // or just don't update it, effectively behaving like it was always in the target.\n                    updatedCards[cardId] = { ...card };\n                }\n                else {\n                    // No place to go, sadly delete (or safeguard in 'Unsorted' if requested, but logic implies delete if no cols)\n                    delete updatedCards[cardId];\n                }\n            });\n        }\n        return {\n            cards: updatedCards,\n            columns: updatedColumns,\n            columnOrder: newColumnOrder,\n        };\n    }),\n    // === MOVEMENT ===\n    moveCard: (cardId, sourceColId, targetColId, newIndex) => set((state) => {\n        const sourceCol = state.columns[sourceColId];\n        const targetCol = state.columns[targetColId];\n        if (!sourceCol || !targetCol)\n            return state;\n        const newSourceCardIds = sourceCol.cardIds.filter(id => id !== cardId);\n        if (sourceColId === targetColId) {\n            newSourceCardIds.splice(newIndex, 0, cardId);\n            return {\n                ...state,\n                columns: {\n                    ...state.columns,\n                    [sourceColId]: { ...sourceCol, cardIds: newSourceCardIds }\n                }\n            };\n        }\n        const newTargetCardIds = [...targetCol.cardIds];\n        newTargetCardIds.splice(newIndex, 0, cardId);\n        // Track previous column for recovery\n        const updatedCard = { ...state.cards[cardId], previousColumnId: sourceColId };\n        return {\n            ...state,\n            cards: { ...state.cards, [cardId]: updatedCard },\n            columns: {\n                ...state.columns,\n                [sourceColId]: { ...sourceCol, cardIds: newSourceCardIds },\n                [targetColId]: { ...targetCol, cardIds: newTargetCardIds }\n            }\n        };\n    }),\n    moveColumn: (columnId, newIndex) => set((state) => {\n        const newOrder = state.columnOrder.filter(id => id !== columnId);\n        newOrder.splice(newIndex, 0, columnId);\n        return { ...state, columnOrder: newOrder };\n    }),\n    addColumnWithCard: (cardId, sourceColId, columnData) => set((state) => {\n        const sourceCol = state.columns[sourceColId];\n        const card = state.cards[cardId];\n        if (!sourceCol || !card)\n            return state;\n        const columnId = generateId();\n        const newColumn = {\n            id: columnId,\n            ...columnData,\n            cardIds: [cardId],\n        };\n        const newSourceCardIds = sourceCol.cardIds.filter(id => id !== cardId);\n        // Strict append to ensuring it goes to the end\n        const newColumnOrder = Array.from(state.columnOrder);\n        newColumnOrder.push(columnId);\n        const updatedCard = { ...card, previousColumnId: sourceColId };\n        return {\n            ...state,\n            cards: { ...state.cards, [cardId]: updatedCard },\n            columns: {\n                ...state.columns,\n                [sourceColId]: { ...sourceCol, cardIds: newSourceCardIds },\n                [columnId]: newColumn\n            },\n            columnOrder: newColumnOrder\n        };\n    }),\n    // === FILTERS ===\n    setSearchQuery: (query) => set((state) => ({\n        filters: { ...state.filters, searchQuery: query }\n    })),\n    addFilterGroup: (group) => set((state) => ({\n        filters: { ...state.filters, groups: [...state.filters.groups, group] }\n    })),\n    updateFilterGroup: (groupId, updates) => set((state) => ({\n        filters: {\n            ...state.filters,\n            groups: state.filters.groups.map(g => g.id === groupId ? { ...g, ...updates } : g)\n        }\n    })),\n    removeFilterGroup: (groupId) => set((state) => ({\n        filters: { ...state.filters, groups: state.filters.groups.filter(g => g.id !== groupId) }\n    })),\n    removeFilterRule: (groupId, ruleId) => set((state) => ({\n        filters: {\n            ...state.filters,\n            groups: state.filters.groups.map(g => {\n                if (g.id !== groupId)\n                    return g;\n                return {\n                    ...g,\n                    rules: g.rules.filter(r => !('id' in r) || r.id !== ruleId)\n                };\n            })\n        }\n    })),\n    setFilters: (filters) => set({ filters }),\n    clearFilters: () => set((state) => ({\n        filters: { ...state.filters, groups: [], searchQuery: '' }\n    })),\n    // === UTILITY ===\n    setBoardData: (data) => set({ ...data }),\n    setConfig: (config) => set((state) => ({ config: { ...state.config, ...config } })),\n    setActiveId: (activeId) => set({ activeId }),\n    setViewingCardId: (viewingCardId) => set({ viewingCardId }),\n    clearViewingCardId: () => set({ viewingCardId: null }),\n    setEditingCardId: (editingCardId) => set({ editingCardId }),\n    clearEditingCardId: () => set({ editingCardId: null }),\n    setAddingCardInColumnId: (addingCardInColumnId) => set({ addingCardInColumnId }),\n    clearAddingCardInColumnId: () => set({ addingCardInColumnId: null }),\n    setEditingColumnId: (editingColumnId) => set({ editingColumnId }),\n    clearEditingColumnId: () => set({ editingColumnId: null }),\n    clearBoard: () => set({\n        cards: {},\n        columns: {},\n        columnOrder: [],\n        filters: { searchQuery: '', groups: [], quickFilters: [] }\n    }),\n})));\n","import { useState, useCallback } from 'react';\nimport { useKanbanStore } from '../store/use-kanban-store';\nexport function useKanban(config) {\n    const store = useKanbanStore();\n    const [activeId, setActiveId] = useState(null);\n    const [overId, setOverId] = useState(null);\n    const [overSide, setOverSide] = useState(null);\n    const handleDragStart = useCallback((cardId) => {\n        setActiveId(cardId);\n    }, []);\n    const handleDragOver = useCallback((id, side) => {\n        setOverId(id);\n        setOverSide(side ?? null);\n    }, []);\n    const handleDragEnd = useCallback(() => {\n        setActiveId(null);\n        setOverId(null);\n        setOverSide(null);\n    }, []);\n    const moveCard = useCallback((cardId, sourceColumnId, targetColumnId, index) => {\n        store.moveCard(cardId, sourceColumnId, targetColumnId, index);\n        config?.onCardMove?.(cardId, sourceColumnId, targetColumnId, index);\n    }, [store, config]);\n    return {\n        // Estado\n        ...store,\n        activeId,\n        overId,\n        overSide,\n        viewingCardId: store.viewingCardId,\n        editingCardId: store.editingCardId,\n        addingCardInColumnId: store.addingCardInColumnId,\n        editingColumnId: store.editingColumnId, // Use store version\n        setViewingCardId: store.setViewingCardId,\n        clearViewingCardId: store.clearViewingCardId,\n        // Ações de Cards\n        handleDragStart,\n        handleDragOver,\n        handleDragEnd,\n        moveCard,\n        addCard: store.addCard,\n        updateCard: store.updateCard,\n        deleteCard: store.deleteCard,\n        duplicateCard: store.duplicateCard,\n        setEditingCardId: store.setEditingCardId,\n        clearEditingCardId: store.clearEditingCardId,\n        setAddingCardInColumnId: store.setAddingCardInColumnId,\n        clearAddingCardInColumnId: store.clearAddingCardInColumnId,\n        // Ações de Colunas\n        addColumn: store.addColumn,\n        addColumnWithCard: store.addColumnWithCard,\n        updateColumn: store.updateColumn,\n        deleteColumn: store.deleteColumn,\n        moveColumn: store.moveColumn,\n        setEditingColumnId: store.setEditingColumnId,\n        clearEditingColumnId: store.clearEditingColumnId,\n        // Utilitários\n        clearBoard: store.clearBoard,\n        // Configurações\n        config: {\n            dragActivationDistance: config?.dragActivationDistance ?? 10,\n            touchActivationDelay: config?.touchActivationDelay ?? 250,\n            virtualOverscan: config?.virtualOverscan ?? 5,\n            estimatedCardHeight: config?.estimatedCardHeight ?? 90,\n            columnWidth: config?.columnWidth ?? 320,\n            columnMinHeight: config?.columnMinHeight ?? 500,\n            gap: config?.gap ?? 16,\n            allowAdd: config?.allowAdd ?? false,\n            allowEdit: config?.allowEdit ?? false,\n            allowColumnAdd: config?.allowColumnAdd ?? false,\n            allowColumnEdit: config?.allowColumnEdit ?? false,\n            allowColumnDelete: config?.allowColumnDelete ?? false,\n            allowColumnReorder: config?.allowColumnReorder ?? false,\n            allowFilters: config?.allowFilters ?? true,\n            showURLSync: config?.showURLSync ?? false,\n        }\n    };\n}\n","import { KeyboardSensor, MouseSensor, TouchSensor, useSensor, useSensors } from '@dnd-kit/core';\nimport { useEffect, useRef } from 'react';\nexport function useKanbanDnd({ dragActivationDistance, touchActivationDelay, onDragStart, onDragOver, onDragEnd, onCardMove, onColumnMove, onCreateColumnWithCard, columns, columnOrder, recentlyMovedToNewContainer }) {\n    // Use refs to avoid stale closures in dnd-kit handlers\n    const columnsRef = useRef(columns);\n    const columnOrderRef = useRef(columnOrder);\n    useEffect(() => {\n        columnsRef.current = columns;\n        columnOrderRef.current = columnOrder;\n    }, [columns, columnOrder]);\n    const dragPositionRef = useRef(null);\n    const sensors = useSensors(useSensor(MouseSensor, {\n        activationConstraint: { distance: dragActivationDistance },\n    }), useSensor(TouchSensor, {\n        activationConstraint: { delay: touchActivationDelay, tolerance: 5 },\n    }), useSensor(KeyboardSensor));\n    const handleDragStart = (event) => {\n        const data = event.active.data.current;\n        const type = data?.type || 'Card';\n        dragPositionRef.current = null;\n        onDragStart(event.active.id, type);\n    };\n    const handleDragOver = (event) => {\n        const { active, over } = event;\n        const activeData = active.data.current;\n        const type = activeData?.type || 'Card';\n        const currentColumns = columnsRef.current;\n        const currentOrder = columnOrderRef.current;\n        if (!over) {\n            onDragOver(null);\n            dragPositionRef.current = null;\n            return;\n        }\n        const activeId = active.id;\n        const overId = over.id;\n        // Detecção de lado (Top/Bottom ou Left/Right)\n        const overRect = over.rect;\n        // Obter coordenadas do mouse/toque dinâmicamente do dnd-kit se possível,\n        // mas o simpler é usar o active rect vs over rect.\n        const activeRect = active.rect.current.translated;\n        let side = null;\n        if (activeRect && overRect) {\n            if (type === 'Column') {\n                const overCenterX = overRect.left + overRect.width / 2;\n                side = activeRect.left + activeRect.width / 2 < overCenterX ? 'left' : 'right';\n            }\n            else {\n                const overCenterY = overRect.top + overRect.height / 2;\n                side = activeRect.top + activeRect.height / 2 < overCenterY ? 'top' : 'bottom';\n            }\n        }\n        onDragOver(overId, side);\n        // --- COLUMN REORDERING ---\n        if (type === 'Column') {\n            let targetColumnId = overId;\n            if (!currentColumns[overId]) {\n                const overCol = Object.values(currentColumns).find(col => col.cardIds.includes(overId));\n                if (overCol) {\n                    targetColumnId = overCol.id;\n                }\n            }\n            const overIndex = currentOrder.indexOf(targetColumnId);\n            const currentIndex = currentOrder.indexOf(activeId);\n            if (overIndex !== -1 && currentIndex !== -1 && currentIndex !== overIndex) {\n                // Live reorder: simple index swap is more stable for horizontal sorting\n                onColumnMove(activeId, overIndex);\n                if (dragPositionRef.current) {\n                    dragPositionRef.current.targetIndex = overIndex;\n                }\n            }\n            return;\n        }\n        // --- CARD MOVEMENT ---\n        // Check if dropping on the \"New Column\" target\n        if (overId === 'new-column-drop-target') {\n            const activeColumn = Object.values(currentColumns).find(col => col.cardIds.includes(activeId));\n            if (activeColumn) {\n                dragPositionRef.current = {\n                    type: 'NewColumn',\n                    activeId,\n                    sourceColumnId: activeColumn.id,\n                    targetIndex: 0\n                };\n            }\n            return;\n        }\n        const activeColumn = Object.values(currentColumns).find(col => col.cardIds.includes(activeId));\n        if (!activeColumn)\n            return;\n        if (currentColumns[overId]) {\n            if (activeColumn.id !== overId) {\n                // Signal that we're moving to a new container\n                if (recentlyMovedToNewContainer) {\n                    recentlyMovedToNewContainer.current = true;\n                }\n                dragPositionRef.current = {\n                    type: 'Card',\n                    activeId,\n                    sourceColumnId: activeColumn.id,\n                    targetColumnId: overId,\n                    targetIndex: currentColumns[overId].cardIds.length,\n                    side: 'bottom' // Default para coluna vazia/header\n                };\n            }\n            else {\n                dragPositionRef.current = null;\n            }\n            return;\n        }\n        const overColumn = Object.values(currentColumns).find(col => col.cardIds.includes(overId));\n        if (!overColumn)\n            return;\n        const overIndex = overColumn.cardIds.indexOf(overId);\n        // Cálculo do index final baseado no lado\n        const finalIndex = side === 'bottom' ? overIndex + 1 : overIndex;\n        if (activeColumn.id !== overColumn.id) {\n            // Signal that we're moving to a new container\n            if (recentlyMovedToNewContainer) {\n                recentlyMovedToNewContainer.current = true;\n            }\n            dragPositionRef.current = {\n                type: 'Card',\n                activeId,\n                sourceColumnId: activeColumn.id,\n                targetColumnId: overColumn.id,\n                targetIndex: finalIndex,\n                side: side\n            };\n        }\n        else {\n            const oldIndex = activeColumn.cardIds.indexOf(activeId);\n            // Na mesma coluna, dnd-kit lida bem com sorting, mas para nossa store:\n            if (oldIndex !== overIndex) {\n                dragPositionRef.current = {\n                    type: 'Card',\n                    activeId,\n                    sourceColumnId: activeColumn.id,\n                    targetColumnId: activeColumn.id,\n                    targetIndex: overIndex, // Para mesma coluna, dnd-kit prefere swap direto ou splice\n                    side: side\n                };\n            }\n        }\n    };\n    const handleDragEnd = () => {\n        if (dragPositionRef.current) {\n            const pos = dragPositionRef.current;\n            if (pos.type === 'NewColumn' && pos.sourceColumnId && onCreateColumnWithCard) {\n                onCreateColumnWithCard(pos.activeId, pos.sourceColumnId);\n            }\n            else if (pos.type === 'Card' && pos.sourceColumnId && pos.targetColumnId) {\n                onCardMove(pos.activeId, pos.sourceColumnId, pos.targetColumnId, pos.targetIndex);\n            }\n            else if (pos.type === 'Column') {\n                onColumnMove(pos.activeId, pos.targetIndex);\n            }\n        }\n        dragPositionRef.current = null;\n        onDragEnd();\n    };\n    return {\n        sensors,\n        handleDragStart,\n        handleDragOver,\n        handleDragEnd\n    };\n}\n","export function evaluateFilter(card, filters) {\n    // 1. Global Search\n    if (filters.searchQuery) {\n        const query = filters.searchQuery.toLowerCase();\n        const titleMatch = card.title?.toLowerCase().includes(query);\n        const descMatch = card.description?.toLowerCase().includes(query);\n        // Also search in metadata values\n        const metadataMatch = card.metadata && Object.values(card.metadata).some(val => String(val).toLowerCase().includes(query));\n        if (!titleMatch && !descMatch && !metadataMatch)\n            return false;\n    }\n    // 2. Advanced Filters (Groups)\n    if (filters.groups.length === 0)\n        return true;\n    // Each group is combined with AND (top level)\n    return filters.groups.every(group => {\n        if (!group.enabled)\n            return true;\n        return evaluateGroup(card, group);\n    });\n}\nfunction evaluateGroup(card, group) {\n    const { conjunction, rules } = group;\n    if (rules.length === 0)\n        return true;\n    if (conjunction === 'and') {\n        return rules.every(rule => {\n            if ('conjunction' in rule)\n                return evaluateGroup(card, rule);\n            return evaluateRule(card, rule);\n        });\n    }\n    else {\n        return rules.some(rule => {\n            if ('conjunction' in rule)\n                return evaluateGroup(card, rule);\n            return evaluateRule(card, rule);\n        });\n    }\n}\nfunction evaluateRule(card, rule) {\n    if (!rule.field || !rule.enabled)\n        return true;\n    const value = getNestedValue(card, rule.field);\n    const target = rule.value;\n    switch (rule.operator) {\n        case 'eq': return value === target;\n        case 'neq': return value !== target;\n        case 'contains':\n            return String(value || '').toLowerCase().includes(String(target || '').toLowerCase());\n        case 'notContains':\n            return !String(value || '').toLowerCase().includes(String(target || '').toLowerCase());\n        case 'gt': return Number(value) > Number(target);\n        case 'gte': return Number(value) >= Number(target);\n        case 'lt': return Number(value) < Number(target);\n        case 'lte': return Number(value) <= Number(target);\n        case 'isEmpty': return !value || (Array.isArray(value) && value.length === 0);\n        case 'isNotEmpty': return !!value && (!Array.isArray(value) || value.length > 0);\n        default: return true;\n    }\n}\nfunction getNestedValue(obj, path) {\n    return path.split('.').reduce((acc, part) => acc && acc[part], obj);\n}\n","import { clsx } from 'clsx';\nimport { twMerge } from 'tailwind-merge';\nexport function cn(...inputs) {\n    return twMerge(clsx(inputs));\n}\n","import { jsx as _jsx, jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { cn } from '@/lib/utils/cn';\nimport { memo } from 'react';\nimport { MoreHorizontal, Paperclip, MessageSquare, Calendar } from 'lucide-react';\nexport const DefaultCard = memo(({ card, isDragging }) => {\n    const { tags, members, commentsCount, attachmentsCount, dueDate, priority } = card.metadata || {};\n    // Priority Color Map\n    const priorityColors = {\n        high: 'bg-red-500',\n        medium: 'bg-amber-500',\n        low: 'bg-emerald-500',\n    };\n    return (_jsxs(\"div\", { className: cn(\"group relative bg-card-bg rounded-card border border-card-border p-3\", \"shadow-card transition-all duration-200 cursor-pointer select-none\", \"hover:shadow-card-hover hover:-translate-y-0.5 hover:border-slate-300\", isDragging && \"opacity-50 grayscale-[0.5] scale-[1.02] shadow-xl border-blue-400 ring-1 ring-blue-400 rotate-2 z-50\", \n        // Priority Indicator on Left\n        priority && \"pl-4\"), children: [priority && (_jsx(\"div\", { className: cn(\"absolute left-0 top-3 bottom-3 w-1 rounded-r-full\", priorityColors[priority] || \"bg-slate-300\") })), _jsxs(\"div\", { className: \"flex flex-col gap-2.5\", children: [tags && tags.length > 0 && (_jsx(\"div\", { className: \"flex flex-wrap gap-1 mb-0.5\", children: tags.map((tag, i) => (_jsx(\"span\", { className: cn(\"px-2 py-0.5 rounded-full text-[10px] font-semibold tracking-tight\", tag.color || \"bg-slate-100 text-slate-600\"), children: tag.name }, i))) })), _jsxs(\"div\", { className: \"flex items-start justify-between gap-2\", children: [_jsx(\"h4\", { className: \"text-sm font-semibold text-slate-800 leading-snug group-hover:text-slate-900 transition-colors\", children: card.title }), _jsx(\"button\", { className: \"opacity-0 group-hover:opacity-100 transition-opacity p-1 hover:bg-slate-100 rounded text-slate-400 hover:text-slate-600 -mr-1 -mt-1\", children: _jsx(MoreHorizontal, { size: 14 }) })] }), card.description && (_jsx(\"p\", { className: \"text-xs text-slate-500 line-clamp-2 leading-relaxed font-medium\", children: card.description })), (members || commentsCount || attachmentsCount || dueDate) && (_jsxs(\"div\", { className: \"flex items-center justify-between mt-1 pt-2.5 border-t border-slate-100/80\", children: [_jsx(\"div\", { className: \"flex items-center\", children: members && members.length > 0 ? (_jsxs(\"div\", { className: \"flex -space-x-2 overflow-hidden py-0.5 pl-0.5\", children: [members.map((m, i) => (_jsx(\"div\", { className: \"h-6 w-6 rounded-full border-2 border-white bg-slate-200 flex items-center justify-center text-[9px] font-bold text-slate-600 ring-1 ring-slate-100\", title: m.name, children: m.avatar ? _jsx(\"img\", { src: m.avatar, alt: m.name, className: \"w-full h-full rounded-full object-cover\" }) : m.initials }, i))), members.length > 3 && (_jsxs(\"div\", { className: \"h-6 w-6 rounded-full border-2 border-white bg-slate-50 flex items-center justify-center text-[9px] font-bold text-slate-400\", children: [\"+\", members.length - 3] }))] })) : _jsx(\"div\", {}) }), _jsxs(\"div\", { className: \"flex items-center gap-3 text-slate-400\", children: [dueDate && (_jsxs(\"div\", { className: cn(\"flex items-center gap-1 text-[10px] font-medium\", new Date(dueDate) < new Date() ? \"text-red-500\" : \"text-slate-400\"), children: [_jsx(Calendar, { size: 12 }), _jsx(\"span\", { children: new Date(dueDate).toLocaleDateString(undefined, { month: 'short', day: 'numeric' }) })] })), commentsCount > 0 && (_jsxs(\"div\", { className: \"flex items-center gap-1 text-[10px] font-medium hover:text-slate-600 transition-colors\", children: [_jsx(MessageSquare, { size: 12 }), _jsx(\"span\", { children: commentsCount })] })), attachmentsCount > 0 && (_jsxs(\"div\", { className: \"flex items-center gap-1 text-[10px] font-medium hover:text-slate-600 transition-colors\", children: [_jsx(Paperclip, { size: 12 }), _jsx(\"span\", { children: attachmentsCount })] }))] })] }))] })] }));\n}, (prevProps, nextProps) => {\n    // Deep comparison for metadata is risky but we'll check key props\n    return (prevProps.card.id === nextProps.card.id &&\n        prevProps.card.title === nextProps.card.title &&\n        prevProps.card.description === nextProps.card.description &&\n        prevProps.isDragging === nextProps.isDragging &&\n        JSON.stringify(prevProps.card.metadata) === JSON.stringify(nextProps.card.metadata));\n});\nDefaultCard.displayName = 'DefaultCard';\n","import { jsx as _jsx } from \"react/jsx-runtime\";\nimport { memo } from 'react';\nexport const DefaultColumnEmpty = memo(() => {\n    return (_jsx(\"div\", { className: \"flex items-center justify-center h-32 text-slate-400 text-sm\", children: \"Arraste cards aqui\" }));\n});\nDefaultColumnEmpty.displayName = 'DefaultColumnEmpty';\n","import { jsx as _jsx, jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { cn } from '@/lib/utils/cn';\nimport { GripVertical, MoreHorizontal, Plus } from 'lucide-react';\nimport { memo } from 'react';\nexport const DefaultColumnHeader = memo(({ column, cardCount, isOver, dragHandleProps, onAddCard, onEditColumn }) => {\n    return (_jsxs(\"div\", { className: cn(\"px-3 py-3 flex items-center justify-between transition-colors mb-2 rounded-t-xl select-none group/header\", isOver ? \"bg-blue-50/80\" : \"bg-transparent\"), children: [_jsxs(\"div\", { className: \"flex items-center gap-2 min-w-0 flex-1\", children: [dragHandleProps && (_jsx(\"div\", { ...dragHandleProps.attributes, ...dragHandleProps.listeners, onClick: (e) => e.stopPropagation(), className: \"cursor-grab active:cursor-grabbing text-slate-400 hover:text-slate-600 p-0.5 rounded hover:bg-slate-200/50 transition-colors\", children: _jsx(GripVertical, { size: 14 }) })), _jsx(\"h3\", { className: \"font-semibold text-sm text-slate-700 truncate tracking-tight flex-1\", children: column.title }), _jsx(\"span\", { className: \"text-[10px] bg-slate-200/50 border border-slate-200 px-2 py-0.5 rounded-full text-slate-500 font-bold tabular-nums\", children: cardCount })] }), _jsxs(\"div\", { className: \"flex items-center gap-1 opacity-0 group-hover/header:opacity-100 transition-opacity\", children: [onAddCard && (_jsx(\"button\", { onClick: onAddCard, className: \"p-1 hover:bg-slate-200/50 rounded text-slate-400 hover:text-slate-600 transition-colors\", title: \"Adicionar Card\", children: _jsx(Plus, { size: 14 }) })), onEditColumn && (_jsx(\"button\", { onClick: onEditColumn, className: \"p-1 hover:bg-slate-200/50 rounded text-slate-400 hover:text-slate-600 transition-colors\", title: \"Editar Coluna\", children: _jsx(MoreHorizontal, { size: 14 }) }))] })] }));\n});\nDefaultColumnHeader.displayName = 'DefaultColumnHeader';\n","\"use client\";\nimport { jsx as _jsx, jsxs as _jsxs } from \"react/jsx-runtime\";\nimport * as React from \"react\";\nimport * as DialogPrimitive from \"@radix-ui/react-dialog\";\nimport { X } from \"lucide-react\";\nimport { cn } from \"@/lib/utils/utils\";\nconst Dialog = DialogPrimitive.Root;\nconst DialogTrigger = DialogPrimitive.Trigger;\nconst DialogPortal = DialogPrimitive.Portal;\nconst DialogClose = DialogPrimitive.Close;\nconst DialogOverlay = React.forwardRef(({ className, ...props }, ref) => (_jsx(DialogPrimitive.Overlay, { ref: ref, className: cn(\"fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\", className), ...props })));\nDialogOverlay.displayName = DialogPrimitive.Overlay.displayName;\nconst DialogContent = React.forwardRef(({ className, children, ...props }, ref) => (_jsxs(DialogPortal, { children: [_jsx(DialogOverlay, {}), _jsxs(DialogPrimitive.Content, { ref: ref, className: cn(\"fixed left-1/2 top-1/2 z-50 grid w-full max-w-lg -translate-x-1/2 -translate-y-1/2 gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-48% data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-48% sm:rounded-lg\", className), ...props, children: [children, _jsxs(DialogPrimitive.Close, { className: \"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground\", children: [_jsx(X, { className: \"h-4 w-4\" }), _jsx(\"span\", { className: \"sr-only\", children: \"Close\" })] })] })] })));\nDialogContent.displayName = DialogPrimitive.Content.displayName;\nconst DialogHeader = ({ className, ...props }) => (_jsx(\"div\", { className: cn(\"flex flex-col space-y-1.5 text-center sm:text-left\", className), ...props }));\nDialogHeader.displayName = \"DialogHeader\";\nconst DialogFooter = ({ className, ...props }) => (_jsx(\"div\", { className: cn(\"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\", className), ...props }));\nDialogFooter.displayName = \"DialogFooter\";\nconst DialogTitle = React.forwardRef(({ className, ...props }, ref) => (_jsx(DialogPrimitive.Title, { ref: ref, className: cn(\"text-lg font-semibold leading-none tracking-tight\", className), ...props })));\nDialogTitle.displayName = DialogPrimitive.Title.displayName;\nconst DialogDescription = React.forwardRef(({ className, ...props }, ref) => (_jsx(DialogPrimitive.Description, { ref: ref, className: cn(\"text-sm text-muted-foreground\", className), ...props })));\nDialogDescription.displayName = DialogPrimitive.Description.displayName;\nexport { Dialog, DialogPortal, DialogOverlay, DialogClose, DialogTrigger, DialogContent, DialogHeader, DialogFooter, DialogTitle, DialogDescription, };\n","import { jsx as _jsx } from \"react/jsx-runtime\";\nimport * as React from \"react\";\nimport { Slot } from \"@radix-ui/react-slot\";\nimport { cva } from \"class-variance-authority\";\nimport { cn } from \"@/lib/utils/utils\";\nconst buttonVariants = cva(\"inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50\", {\n    variants: {\n        variant: {\n            default: \"bg-primary text-primary-foreground hover:bg-primary/90\",\n            destructive: \"bg-destructive text-destructive-foreground hover:bg-destructive/90\",\n            outline: \"border border-input bg-background hover:bg-accent hover:text-accent-foreground\",\n            secondary: \"bg-secondary text-secondary-foreground hover:bg-secondary/80\",\n            ghost: \"hover:bg-accent hover:text-accent-foreground\",\n            link: \"text-primary underline-offset-4 hover:underline\",\n        },\n        size: {\n            default: \"h-10 px-4 py-2\",\n            sm: \"h-9 rounded-md px-3\",\n            lg: \"h-11 rounded-md px-8\",\n            icon: \"h-10 w-10\",\n        },\n    },\n    defaultVariants: {\n        variant: \"default\",\n        size: \"default\",\n    },\n});\nconst Button = React.forwardRef(({ className, variant, size, asChild = false, ...props }, ref) => {\n    const Comp = asChild ? Slot : \"button\";\n    return (_jsx(Comp, { className: cn(buttonVariants({ variant, size, className })), ref: ref, ...props }));\n});\nButton.displayName = \"Button\";\nexport { Button, buttonVariants };\n","import { jsx as _jsx, jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { useState } from 'react';\nimport { Save, Trash2 } from 'lucide-react';\nimport { Dialog, DialogContent, DialogDescription, DialogFooter, DialogHeader, DialogTitle, } from \"@/components/ui/dialog\";\nimport { Button } from \"@/components/ui/button\";\nexport function DefaultEditForm({ card, onSave, onCancel, onDelete }) {\n    const [title, setTitle] = useState(card.title || '');\n    const [description, setDescription] = useState(card.description || '');\n    const handleSubmit = (e) => {\n        e.preventDefault();\n        onSave({ title, description });\n    };\n    return (_jsx(Dialog, { open: true, onOpenChange: (open) => !open && onCancel(), children: _jsxs(DialogContent, { className: \"sm:max-w-[425px]\", children: [_jsxs(DialogHeader, { children: [_jsx(DialogTitle, { children: \"Editar Card\" }), _jsx(DialogDescription, { children: \"Fa\\u00E7a altera\\u00E7\\u00F5es no card aqui. Clique em salvar quando terminar.\" })] }), _jsxs(\"form\", { onSubmit: handleSubmit, className: \"grid gap-4 py-4\", children: [_jsxs(\"div\", { className: \"grid gap-2\", children: [_jsx(\"label\", { htmlFor: \"title\", className: \"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\", children: \"T\\u00EDtulo\" }), _jsx(\"input\", { id: \"title\", autoFocus: true, value: title, onChange: (e) => setTitle(e.target.value), className: \"flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-sm shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50\", placeholder: \"Digite o t\\u00EDtulo...\" })] }), _jsxs(\"div\", { className: \"grid gap-2\", children: [_jsx(\"label\", { htmlFor: \"desc\", className: \"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\", children: \"Descri\\u00E7\\u00E3o\" }), _jsx(\"textarea\", { id: \"desc\", value: description, onChange: (e) => setDescription(e.target.value), rows: 4, className: \"flex min-h-[60px] w-full rounded-md border border-input bg-transparent px-3 py-2 text-sm shadow-sm placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 resize-none\", placeholder: \"Adicione uma descri\\u00E7\\u00E3o...\" })] }), _jsxs(DialogFooter, { className: \"flex items-center justify-between w-full sm:justify-between\", children: [onDelete && (_jsxs(Button, { type: \"button\", variant: \"destructive\", size: \"sm\", onClick: onDelete, className: \"gap-2\", children: [_jsx(Trash2, { size: 14 }), \"Excluir\"] })), _jsxs(\"div\", { className: \"flex gap-2\", children: [_jsx(Button, { type: \"button\", variant: \"outline\", onClick: onCancel, children: \"Cancelar\" }), _jsxs(Button, { type: \"submit\", className: \"gap-2\", children: [_jsx(Save, { size: 14 }), \"Salvar\"] })] })] })] })] }) }));\n}\n","import { jsx as _jsx, jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { Dialog, DialogContent, DialogHeader, DialogTitle } from '@/components/ui/dialog';\nimport { Button } from '@/components/ui/button';\nimport { Calendar, User, Tag, AlignLeft, Info } from 'lucide-react';\nimport { memo } from 'react';\nimport { cn } from '@/lib/utils/cn';\nexport const DefaultCardView = memo(({ card, onClose }) => {\n    const { priority, tags, members, dueDate, ...otherMetadata } = card.metadata || {};\n    const priorityConfig = {\n        high: { label: 'Alta', color: 'text-red-700', bg: 'bg-red-50 border-red-200' },\n        medium: { label: 'Média', color: 'text-amber-700', bg: 'bg-amber-50 border-amber-200' },\n        low: { label: 'Baixa', color: 'text-emerald-700', bg: 'bg-emerald-50 border-emerald-200' },\n    };\n    const pConfig = priority && priorityConfig[priority];\n    return (_jsx(Dialog, { open: true, onOpenChange: (open) => !open && onClose(), children: _jsxs(DialogContent, { className: \"sm:max-w-2xl p-0 gap-0 overflow-hidden bg-white\", children: [pConfig && (_jsx(\"div\", { className: cn(\"h-1.5 w-full\", pConfig.bg.split(' ')[0], pConfig.bg.replace('bg-', 'bg-opacity-100')) })), _jsxs(\"div\", { className: \"flex flex-col h-full max-h-[85vh]\", children: [_jsx(DialogHeader, { className: \"p-6 pb-4\", children: _jsxs(\"div\", { className: \"flex items-start gap-4\", children: [_jsx(\"div\", { className: \"mt-1 p-2 bg-slate-100 rounded-lg text-slate-500\", children: _jsx(AlignLeft, { size: 20 }) }), _jsxs(\"div\", { className: \"space-y-1 flex-1\", children: [_jsx(DialogTitle, { className: \"text-xl font-bold text-slate-900 leading-tight\", children: card.title }), _jsx(\"p\", { className: \"text-xs text-slate-400 font-medium uppercase tracking-wider\", children: card.id })] }), pConfig && (_jsx(\"div\", { className: cn(\"px-3 py-1 rounded-full text-xs font-bold border uppercase tracking-wide\", pConfig.color, pConfig.bg), children: pConfig.label }))] }) }), _jsxs(\"div\", { className: \"flex-1 overflow-y-auto p-6 pt-0 grid md:grid-cols-[1fr,240px] gap-8\", children: [_jsxs(\"div\", { className: \"space-y-6\", children: [_jsxs(\"div\", { className: \"space-y-3\", children: [_jsx(\"h4\", { className: \"text-sm font-semibold text-slate-900 flex items-center gap-2\", children: \"Descri\\u00E7\\u00E3o\" }), _jsx(\"div\", { className: cn(\"text-sm text-slate-600 leading-relaxed p-4 rounded-lg border border-slate-100 bg-slate-50/50 min-h-[100px]\", !card.description && \"italic text-slate-400 flex items-center justify-center\"), children: card.description || \"Nenhuma descrição fornecida.\" })] }), card.content && (_jsxs(\"div\", { className: \"space-y-3\", children: [_jsx(\"h4\", { className: \"text-sm font-semibold text-slate-900\", children: \"Conte\\u00FAdo Detalhado\" }), _jsx(\"pre\", { className: \"text-xs font-mono bg-slate-900 text-slate-50 p-4 rounded-lg overflow-x-auto shadow-inner\", children: typeof card.content === 'object' ? JSON.stringify(card.content, null, 2) : card.content })] }))] }), _jsxs(\"div\", { className: \"space-y-6\", children: [dueDate && (_jsxs(\"div\", { className: \"space-y-1.5\", children: [_jsxs(\"span\", { className: \"text-xs font-semibold text-slate-500 uppercase tracking-wider flex items-center gap-1.5\", children: [_jsx(Calendar, { size: 12 }), \" Data de Entrega\"] }), _jsx(\"div\", { className: \"text-sm font-medium text-slate-900 bg-slate-50 px-3 py-2 rounded-md border border-slate-200\", children: new Date(dueDate).toLocaleDateString() })] })), members && Array.isArray(members) && members.length > 0 && (_jsxs(\"div\", { className: \"space-y-2\", children: [_jsxs(\"span\", { className: \"text-xs font-semibold text-slate-500 uppercase tracking-wider flex items-center gap-1.5\", children: [_jsx(User, { size: 12 }), \" Membros\"] }), _jsx(\"div\", { className: \"flex flex-col gap-2\", children: members.map((m, i) => (_jsxs(\"div\", { className: \"flex items-center gap-2 text-sm text-slate-700 bg-white p-1.5 rounded-md border border-slate-100 shadow-sm\", children: [_jsx(\"div\", { className: \"h-6 w-6 rounded-full bg-slate-200 flex items-center justify-center text-[10px] font-bold overflow-hidden shrink-0\", children: m.avatar ? _jsx(\"img\", { src: m.avatar, alt: m.name, className: \"w-full h-full object-cover\" }) : m.initials }), _jsx(\"span\", { className: \"truncate\", children: m.name })] }, i))) })] })), tags && Array.isArray(tags) && tags.length > 0 && (_jsxs(\"div\", { className: \"space-y-2\", children: [_jsxs(\"span\", { className: \"text-xs font-semibold text-slate-500 uppercase tracking-wider flex items-center gap-1.5\", children: [_jsx(Tag, { size: 12 }), \" Tags\"] }), _jsx(\"div\", { className: \"flex flex-wrap gap-1.5\", children: tags.map((tag, i) => (_jsx(\"span\", { className: cn(\"px-2.5 py-1 rounded-md text-xs font-semibold border shadow-sm\", tag.color ? `bg-${tag.color}-50 text-${tag.color}-700 border-${tag.color}-200` : \"bg-slate-100 text-slate-700 border-slate-200\"), children: tag.name }, i))) })] })), Object.keys(otherMetadata).length > 0 && (_jsxs(\"div\", { className: \"space-y-3 pt-4 border-t border-slate-100\", children: [_jsxs(\"span\", { className: \"text-xs font-semibold text-slate-500 uppercase tracking-wider flex items-center gap-1.5\", children: [_jsx(Info, { size: 12 }), \" Outros Detalhes\"] }), _jsx(\"div\", { className: \"grid gap-3\", children: Object.entries(otherMetadata).map(([key, value]) => (_jsxs(\"div\", { className: \"group\", children: [_jsx(\"dt\", { className: \"text-[10px] font-bold text-slate-400 uppercase mb-0.5 group-hover:text-slate-600 transition-colors\", children: key.replace(/([A-Z])/g, ' $1') }), _jsx(\"dd\", { className: \"text-sm font-medium text-slate-800 break-words\", children: typeof value === 'boolean' ? (value ? _jsx(\"span\", { className: \"inline-flex items-center gap-1 text-emerald-600 bg-emerald-50 px-2 py-0.5 rounded text-xs\", children: \"Sim\" }) : _jsx(\"span\", { className: \"text-slate-400\", children: \"N\\u00E3o\" })) : String(value) })] }, key))) })] }))] })] }), _jsx(\"div\", { className: \"p-4 border-t border-slate-100 bg-slate-50/50 flex justify-end\", children: _jsx(Button, { variant: \"outline\", onClick: onClose, className: \"hover:bg-white hover:text-slate-900 transition-colors\", children: \"Fechar Visualiza\\u00E7\\u00E3o\" }) })] })] }) }));\n});\n","import { jsx as _jsx, jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { useKanbanStore } from '@/lib/store/use-kanban-store';\nimport { Button } from '@/components/ui/button';\nimport { X, RotateCcw } from 'lucide-react';\nexport function FilterChips() {\n    const { filters, removeFilterRule, clearFilters } = useKanbanStore();\n    const activeRules = filters.groups.flatMap(group => group.rules\n        .filter(rule => !('conjunction' in rule) && rule.enabled)\n        .map(rule => ({ groupId: group.id, rule: rule })));\n    if (activeRules.length === 0 && !filters.searchQuery)\n        return null;\n    return (_jsxs(\"div\", { className: \"flex flex-wrap items-center gap-2 px-4 py-2 bg-slate-50/50 border-b min-h-[48px] animate-in fade-in slide-in-from-top-1 duration-300\", children: [_jsxs(\"div\", { className: \"flex items-center gap-1.5 mr-2\", children: [_jsx(\"div\", { className: \"h-2 w-2 rounded-full bg-primary animate-pulse\" }), _jsx(\"span\", { className: \"text-[11px] font-bold text-slate-500 uppercase tracking-tight\", children: \"Filtros Ativos:\" })] }), filters.searchQuery && (_jsxs(\"div\", { className: \"flex items-center gap-1 bg-white border border-primary/20 rounded-full px-3 py-1 text-[11px] shadow-sm\", children: [_jsx(\"span\", { className: \"text-slate-500\", children: \"Busca:\" }), _jsx(\"span\", { className: \"font-semibold text-primary\", children: filters.searchQuery }), _jsx(\"button\", { onClick: () => useKanbanStore.getState().setSearchQuery(''), className: \"ml-1 hover:text-destructive transition-colors\", children: _jsx(X, { className: \"h-3 w-3\" }) })] })), activeRules.map(({ groupId, rule }) => (_jsxs(\"div\", { className: \"flex items-center gap-1 bg-white border border-slate-200 rounded-full px-3 py-1 text-[11px] shadow-sm hover:border-primary/30 transition-colors group\", children: [_jsxs(\"span\", { className: \"text-slate-400 capitalize\", children: [rule.field.split('.').pop(), \":\"] }), _jsx(\"span\", { className: \"font-semibold text-slate-700\", children: rule.value || '(vazio)' }), _jsx(\"button\", { onClick: () => removeFilterRule(groupId, rule.id), className: \"ml-1 text-slate-300 group-hover:text-destructive transition-colors\", children: _jsx(X, { className: \"h-3 w-3\" }) })] }, rule.id))), _jsxs(Button, { variant: \"ghost\", size: \"sm\", className: \"h-7 text-[10px] font-bold text-slate-400 hover:text-destructive gap-1 px-2 border-l ml-auto rounded-none\", onClick: clearFilters, children: [_jsx(RotateCcw, { className: \"h-3 w-3\" }), \"LIMPAR TUDO\"] })] }));\n}\n","import { useRef, useEffect, useState, useMemo } from 'react';\nimport { useVirtualizer } from '@tanstack/react-virtual';\n// Cache de medições de altura por card ID\nconst heightCache = new Map();\nexport function useKanbanColumn({ cardIds, estimatedCardHeight, overscan: baseOverscan }) {\n    const parentRef = useRef(null);\n    const [scrollVelocity, setScrollVelocity] = useState(0);\n    // NOTE: We removed useDroppable here because the column is already \n    // registered as a droppable via useSortable in SortableVirtualColumn.\n    // Having two registrations with the same ID causes conflicts.\n    useEffect(() => {\n        const element = parentRef.current;\n        if (!element)\n            return;\n        let lastScrollTop = 0;\n        let lastTime = Date.now();\n        let rafId;\n        const handleScroll = () => {\n            const now = Date.now();\n            const scrollTop = element.scrollTop;\n            const deltaTime = now - lastTime;\n            const deltaScroll = Math.abs(scrollTop - lastScrollTop);\n            if (deltaTime > 0) {\n                const velocity = deltaScroll / deltaTime;\n                setScrollVelocity(velocity);\n            }\n            lastScrollTop = scrollTop;\n            lastTime = now;\n        };\n        const throttledScroll = () => {\n            if (rafId)\n                cancelAnimationFrame(rafId);\n            rafId = requestAnimationFrame(handleScroll);\n        };\n        element.addEventListener('scroll', throttledScroll, { passive: true });\n        return () => {\n            element.removeEventListener('scroll', throttledScroll);\n            if (rafId)\n                cancelAnimationFrame(rafId);\n        };\n    }, []);\n    // Overscan dinâmico baseado em velocidade\n    const dynamicOverscan = useMemo(() => {\n        if (scrollVelocity > 2000)\n            return baseOverscan * 3;\n        if (scrollVelocity > 1000)\n            return baseOverscan * 2;\n        if (scrollVelocity > 500)\n            return Math.ceil(baseOverscan * 1.5);\n        return baseOverscan;\n    }, [scrollVelocity, baseOverscan]);\n    const rowVirtualizer = useVirtualizer({\n        count: cardIds.length,\n        getScrollElement: () => parentRef.current,\n        estimateSize: (index) => {\n            const cardId = cardIds[index];\n            const cached = heightCache.get(cardId);\n            if (cached)\n                return cached;\n            return estimatedCardHeight;\n        },\n        measureElement: (element) => {\n            const height = element.getBoundingClientRect().height;\n            const cardId = element.getAttribute('data-card-id');\n            if (cardId) {\n                heightCache.set(cardId, height);\n            }\n            return height;\n        },\n        overscan: dynamicOverscan,\n    });\n    return {\n        parentRef,\n        rowVirtualizer\n    };\n}\n","import { jsx as _jsx, jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { Plus } from 'lucide-react';\nexport function AddCardButton({ onClick }) {\n    return (_jsxs(\"button\", { onClick: onClick, className: \"w-full flex items-center gap-2 px-3 py-2 text-sm font-medium text-slate-500 hover:text-blue-600 hover:bg-blue-50/50 rounded-lg transition-all duration-200 group\", children: [_jsx(\"div\", { className: \"bg-slate-200 group-hover:bg-blue-600 group-hover:text-white p-0.5 rounded transition-colors\", children: _jsx(Plus, { size: 14 }) }), _jsx(\"span\", { children: \"Adicionar card\" })] }));\n}\n","import { jsx as _jsx, jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { memo, useMemo } from 'react';\nimport { useSortable } from '@dnd-kit/sortable';\nimport { CSS } from '@dnd-kit/utilities';\n// Lightweight sortable wrapper - only this re-renders during drag\nfunction KanbanCardInner({ card, renderCard, onClick, onEdit, allowEdit, index, columnId, overId, overSide }) {\n    const { attributes, listeners, setNodeRef, transform, transition, isDragging: isSortableDragging } = useSortable({\n        id: card.id,\n        data: {\n            type: 'Card',\n            card,\n            index,\n            columnId\n        }\n    });\n    const style = useMemo(() => ({\n        transform: CSS.Translate.toString(transform),\n        transition,\n        opacity: isSortableDragging ? 0.4 : 1,\n    }), [transform, transition, isSortableDragging]);\n    const handleClick = useMemo(() => {\n        return (e) => {\n            e.stopPropagation();\n            if (onClick) {\n                onClick(card);\n            }\n            else if (allowEdit) {\n                onEdit?.(card);\n            }\n        };\n    }, [onClick, onEdit, allowEdit, card]);\n    // Render card content - memoized by DefaultCard component\n    const cardContent = useMemo(() => renderCard({ card, isDragging: isSortableDragging }), [card, renderCard, isSortableDragging]);\n    return (_jsxs(\"div\", { ref: setNodeRef, style: style, ...attributes, ...listeners, onClick: handleClick, className: \"relative cursor-grab active:cursor-grabbing touch-none group\", children: [overId === card.id && overSide === 'top' && (_jsx(\"div\", { className: \"absolute -top-[2px] left-0 right-0 h-[4px] bg-blue-500 rounded-full z-10 pointer-events-none shadow-sm\" })), cardContent, overId === card.id && overSide === 'bottom' && (_jsx(\"div\", { className: \"absolute -bottom-[2px] left-0 right-0 h-[4px] bg-blue-500 rounded-full z-10 pointer-events-none shadow-sm\" }))] }));\n}\nexport const KanbanCard = memo(KanbanCardInner, (prevProps, nextProps) => {\n    return (prevProps.card === nextProps.card &&\n        prevProps.index === nextProps.index &&\n        prevProps.columnId === nextProps.columnId &&\n        prevProps.overId === nextProps.overId &&\n        prevProps.overSide === nextProps.overSide);\n});\n","import { jsx as _jsx, jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { SortableContext, verticalListSortingStrategy } from '@dnd-kit/sortable';\nimport { memo } from 'react';\nimport { useKanbanColumn } from '../hooks/use-kanban-column';\nimport { useKanbanStore } from '../store/use-kanban-store';\nimport { cn } from '../utils/cn';\nimport { AddCardButton } from './add-card-button';\nimport { KanbanCard } from './kanban-card';\nfunction KanbanColumnInner({ column, allCards, activeId, overId, overSide, config, dragHandleProps, isActiveColumnDragging, isDragging, isOverlay }) {\n    const columnData = column;\n    const { setAddingCardInColumnId, setEditingColumnId } = useKanbanStore();\n    const { parentRef, rowVirtualizer } = useKanbanColumn({\n        cardIds: columnData.cardIds,\n        estimatedCardHeight: config.estimatedCardHeight,\n        overscan: config.virtualOverscan\n    });\n    // isOver is now managed by the parent SortableVirtualColumn\n    const isColumnOver = overId === columnData.id;\n    const handleColumnClick = (e) => {\n        e.stopPropagation();\n        if (config.onColumnClick) {\n            config.onColumnClick(column);\n        }\n        else if (config.allowColumnEdit) {\n            config.onEditColumn?.(column); // Custom handler\n            // or open default modal if no custom handler? \n            // Current design prefers Store control for default modals.\n            // We'll also set Store ID for default behavior compatibility if no custom handler prevents it.\n            setEditingColumnId(columnData.id);\n        }\n    };\n    return (_jsxs(\"div\", { onClick: handleColumnClick, style: {\n            width: config.columnWidth,\n            maxHeight: '100%',\n            boxSizing: 'border-box'\n        }, className: cn(\"flex flex-col group/column bg-column-bg rounded-column transition-all relative select-none h-fit max-h-full\", \"duration-250 ease-[cubic-bezier(0.18,0.67,0.6,1.22)]\", // Spring-like transition\n        isColumnOver && \"bg-blue-50/50 ring-1 ring-blue-300 shadow-sm\", isActiveColumnDragging && !isDragging && !isOverlay && \"scale-[0.98] border border-slate-200 border-dashed opacity-50\", // Other columns\n        isDragging && !isOverlay && \"opacity-20\", // Placeholder\n        isOverlay && \"bg-slate-100/80 shadow-[0_20px_50px_rgba(0,0,0,0.15)] scale-[1.02] z-50 cursor-grabbing ring-1 ring-slate-300\" // Overlay\n        ), children: [overId === columnData.id && overSide === 'left' && (_jsx(\"div\", { className: \"absolute top-0 bottom-0 -left-[4px] w-[4px] bg-blue-500 rounded-full z-20 pointer-events-none shadow-sm\" })), overId === columnData.id && overSide === 'right' && (_jsx(\"div\", { className: \"absolute top-0 bottom-0 -right-[4px] w-[4px] bg-blue-500 rounded-full z-20 pointer-events-none shadow-sm\" })), _jsx(\"div\", { onClick: (e) => e.stopPropagation(), children: config.renderColumnHeader({\n                    column,\n                    cardCount: columnData.cardIds.length,\n                    isOver: isColumnOver,\n                    dragHandleProps,\n                    onAddCard: config.allowAdd ? () => setAddingCardInColumnId(columnData.id) : undefined,\n                    onEditColumn: config.allowColumnEdit ? () => setEditingColumnId(columnData.id) : undefined\n                }) }), _jsx(\"div\", { className: cn(\"flex-1 flex flex-col min-h-0 transition-colors duration-200\", isColumnOver && \"bg-blue-50/30\"), style: { minHeight: config.columnMinHeight }, children: columnData.cardIds.length === 0 ? (\n                // Empty column - simple area with parentRef for eventual virtualizer stability\n                _jsx(\"div\", { ref: parentRef, className: cn(\"flex-1 px-3 pb-2 flex items-center justify-center border-2 border-dashed border-transparent rounded-b-lg transition-colors\", isColumnOver && \"border-blue-300\"), children: _jsx(\"div\", { className: \"pointer-events-none select-none opacity-50\", children: config.renderColumnEmpty({}) }) })) : (\n                // Column with cards - use SortableContext for reordering\n                _jsx(SortableContext, { items: columnData.cardIds, strategy: verticalListSortingStrategy, children: _jsx(\"div\", { ref: parentRef, className: \"flex-1 overflow-y-auto px-3 pb-2 scrollbar-thin scrollbar-thumb-slate-300 scrollbar-track-transparent\", style: { minHeight: config.columnMinHeight }, children: _jsx(\"div\", { style: {\n                                height: `${rowVirtualizer.getTotalSize()}px`,\n                                width: '100%',\n                                position: 'relative',\n                            }, children: rowVirtualizer.getVirtualItems().map((virtualRow) => {\n                                const cardId = columnData.cardIds[virtualRow.index];\n                                const card = allCards[cardId];\n                                if (!card)\n                                    return null;\n                                const isActive = cardId === activeId;\n                                return (_jsx(\"div\", { \"data-index\": virtualRow.index, \"data-card-id\": cardId, style: {\n                                        position: 'absolute',\n                                        top: 0,\n                                        left: 0,\n                                        width: '100%',\n                                        height: `${virtualRow.size}px`,\n                                        transform: `translateY(${virtualRow.start}px)`,\n                                    }, children: _jsx(KanbanCard, { card: card, isDragging: isActive, renderCard: config.renderCard, onClick: config.onCardClick, onEdit: config.onEditCard, allowEdit: config.allowEdit, index: virtualRow.index, columnId: columnData.id, overId: overId, overSide: overSide }) }, cardId));\n                            }) }) }) })) }), config.allowAdd && (_jsx(\"div\", { className: \"p-3 border-t border-slate-200 shrink-0 relative z-20\", onClick: (e) => e.stopPropagation(), children: config.renderAddButton ? (config.renderAddButton({\n                    columnId: columnData.id,\n                    onClick: () => setAddingCardInColumnId(columnData.id)\n                })) : (_jsx(AddCardButton, { onClick: () => setAddingCardInColumnId(columnData.id) })) }))] }));\n}\nexport const KanbanColumn = memo(KanbanColumnInner);\n","import { jsx as _jsx, jsxs as _jsxs } from \"react/jsx-runtime\";\nimport * as React from \"react\";\nimport * as SheetPrimitive from \"@radix-ui/react-dialog\";\nimport { cva } from \"class-variance-authority\";\nimport { X } from \"lucide-react\";\nimport { cn } from \"@/lib/utils/utils\";\nconst Sheet = SheetPrimitive.Root;\nconst SheetTrigger = SheetPrimitive.Trigger;\nconst SheetClose = SheetPrimitive.Close;\nconst SheetPortal = SheetPrimitive.Portal;\nconst SheetOverlay = React.forwardRef(({ className, ...props }, ref) => (_jsx(SheetPrimitive.Overlay, { className: cn(\"fixed inset-0 z-50 bg-black/40 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\", className), ...props, ref: ref })));\nSheetOverlay.displayName = SheetPrimitive.Overlay.displayName;\nconst sheetVariants = cva(\"fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:duration-300 data-[state=open]:duration-500\", {\n    variants: {\n        side: {\n            top: \"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top\",\n            bottom: \"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom\",\n            left: \"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm\",\n            right: \"inset-y-0 right-0 h-full w-3/4 border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm\",\n        },\n    },\n    defaultVariants: {\n        side: \"right\",\n    },\n});\nconst SheetContent = React.forwardRef(({ side = \"right\", className, children, ...props }, ref) => (_jsx(SheetPortal, { children: _jsxs(SheetPrimitive.Content, { ref: ref, className: cn(sheetVariants({ side }), \"bg-white shadow-2xl\", className), ...props, children: [children, _jsxs(SheetPrimitive.Close, { className: \"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary\", children: [_jsx(X, { className: \"h-4 w-4\" }), _jsx(\"span\", { className: \"sr-only\", children: \"Close\" })] })] }) })));\nSheetContent.displayName = SheetPrimitive.Content.displayName;\nconst SheetHeader = ({ className, ...props }) => (_jsx(\"div\", { className: cn(\"flex flex-col space-y-2 text-center sm:text-left\", className), ...props }));\nSheetHeader.displayName = \"SheetHeader\";\nconst SheetFooter = ({ className, ...props }) => (_jsx(\"div\", { className: cn(\"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\", className), ...props }));\nSheetFooter.displayName = \"SheetFooter\";\nconst SheetTitle = React.forwardRef(({ className, ...props }, ref) => (_jsx(SheetPrimitive.Title, { ref: ref, className: cn(\"text-lg font-semibold text-foreground\", className), ...props })));\nSheetTitle.displayName = SheetPrimitive.Title.displayName;\nconst SheetDescription = React.forwardRef(({ className, ...props }, ref) => (_jsx(SheetPrimitive.Description, { ref: ref, className: cn(\"text-sm text-muted-foreground\", className), ...props })));\nSheetDescription.displayName = SheetPrimitive.Description.displayName;\nexport { Sheet, SheetPortal, SheetOverlay, SheetTrigger, SheetClose, SheetContent, SheetHeader, SheetFooter, SheetTitle, SheetDescription, };\n","import { jsx as _jsx, jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { Trash2, Plus, X } from 'lucide-react';\nimport { useKanbanStore } from '@/lib/store/use-kanban-store';\nimport { Button } from '@/components/ui/button';\nexport function FilterGroup({ group, availableFields }) {\n    const { updateFilterGroup, removeFilterGroup } = useKanbanStore();\n    const handleAddRule = () => {\n        const newRule = {\n            id: crypto.randomUUID(),\n            field: '',\n            operator: 'contains',\n            value: '',\n            enabled: true\n        };\n        updateFilterGroup(group.id, {\n            rules: [...group.rules, newRule]\n        });\n    };\n    const handleRemoveRule = (ruleId) => {\n        updateFilterGroup(group.id, {\n            rules: group.rules.filter(r => 'id' in r && r.id !== ruleId)\n        });\n    };\n    const handleUpdateRule = (ruleId, updates) => {\n        updateFilterGroup(group.id, {\n            rules: group.rules.map(r => ('id' in r && r.id === ruleId) ? { ...r, ...updates } : r)\n        });\n    };\n    const toggleConjunction = () => {\n        updateFilterGroup(group.id, {\n            conjunction: group.conjunction === 'and' ? 'or' : 'and'\n        });\n    };\n    return (_jsxs(\"div\", { className: \"p-4 border rounded-lg bg-slate-50/50 space-y-4 relative group\", children: [_jsxs(\"div\", { className: \"flex items-center justify-between\", children: [_jsxs(\"div\", { className: \"flex items-center gap-2\", children: [_jsx(Button, { variant: \"ghost\", size: \"sm\", className: \"h-7 text-[10px] uppercase font-bold tracking-wider hover:bg-white\", onClick: toggleConjunction, children: group.conjunction }), _jsx(\"span\", { className: \"text-xs text-muted-foreground italic\", children: \"dos seguintes crit\\u00E9rios:\" })] }), _jsx(Button, { variant: \"ghost\", size: \"icon\", className: \"h-8 w-8 text-destructive opacity-0 group-hover:opacity-100 transition-opacity\", onClick: () => removeFilterGroup(group.id), children: _jsx(Trash2, { className: \"h-4 w-4\" }) })] }), _jsxs(\"div\", { className: \"space-y-3\", children: [group.rules.map((rule) => {\n                        if ('field' in rule) {\n                            return (_jsx(FilterRuleRow, { rule: rule, availableFields: availableFields, onDelete: () => handleRemoveRule(rule.id), onUpdate: (updates) => handleUpdateRule(rule.id, updates) }, rule.id));\n                        }\n                        return null; // Nested groups not supported in basic UI yet\n                    }), group.rules.length === 0 && (_jsx(\"div\", { className: \"text-center py-4 border-2 border-dashed rounded-md bg-white/50 cursor-pointer hover:bg-white transition-colors\", onClick: handleAddRule, children: _jsx(\"p\", { className: \"text-xs text-muted-foreground\", children: \"Nenhuma regra definida. Clique para adicionar.\" }) }))] }), _jsxs(Button, { variant: \"ghost\", size: \"sm\", className: \"w-full h-8 text-xs border-dashed border hover:border-solid mt-2 bg-white\", onClick: handleAddRule, children: [_jsx(Plus, { className: \"mr-2 h-3 w-3\" }), \"Adicionar Regra\"] })] }));\n}\nfunction FilterRuleRow({ rule, availableFields, onDelete, onUpdate }) {\n    const operators = [\n        { label: 'contém', value: 'contains' },\n        { label: 'não contém', value: 'notContains' },\n        { label: 'igual a', value: 'eq' },\n        { label: 'diferente de', value: 'neq' },\n        { label: 'maior que', value: 'gt' },\n        { label: 'menor que', value: 'lt' },\n        { label: 'está vazio', value: 'isEmpty' },\n        { label: 'não está vazio', value: 'isNotEmpty' },\n    ];\n    return (_jsxs(\"div\", { className: `flex items-center gap-2 bg-white p-2 rounded-md border shadow-sm transition-all duration-200 group/row ${!rule.enabled ? 'opacity-50 grayscale bg-slate-50' : 'hover:border-primary/30'}`, children: [_jsx(\"input\", { type: \"checkbox\", checked: rule.enabled, onChange: (e) => onUpdate({ enabled: e.target.checked }), className: \"h-3 w-3 rounded border-slate-300 text-primary focus:ring-primary cursor-pointer\", title: rule.enabled ? 'Desabilitar regra' : 'Habilitar regra' }), _jsxs(\"select\", { value: rule.field, onChange: (e) => onUpdate({ field: e.target.value }), className: \"flex-[1.5] min-w-[100px] bg-transparent text-[11px] font-semibold focus:outline-none truncate\", disabled: !rule.enabled, children: [_jsx(\"option\", { value: \"\", disabled: true, children: \"Campo...\" }), availableFields.map(f => (_jsx(\"option\", { value: f.value, children: f.label }, f.value)))] }), _jsx(\"select\", { value: rule.operator, onChange: (e) => onUpdate({ operator: e.target.value }), className: \"flex-1 min-w-[90px] bg-transparent text-[11px] text-muted-foreground focus:outline-none border-x px-2\", disabled: !rule.enabled, children: operators.map(o => (_jsx(\"option\", { value: o.value, children: o.label }, o.value))) }), _jsx(\"input\", { type: (availableFields.find(f => f.value === rule.field)?.type ?? 'text') === 'number' ? 'number' : 'text', value: rule.value || '', onChange: (e) => onUpdate({ value: e.target.value }), placeholder: \"Valor...\", disabled: !rule.enabled || rule.operator === 'isEmpty' || rule.operator === 'isNotEmpty', className: \"flex-[2] min-w-[100px] bg-transparent text-[11px] focus:outline-none placeholder:italic disabled:opacity-30 font-medium\" }), _jsx(Button, { variant: \"ghost\", size: \"icon\", className: \"h-6 w-6 shrink-0 hover:bg-destructive/10 hover:text-destructive opacity-0 group-row-hover/row:opacity-100 transition-opacity\", onClick: onDelete, children: _jsx(X, { className: \"h-3 w-3\" }) })] }));\n}\n","export function discoverFields(cards) {\n    const fields = {\n        title: { label: 'Título', value: 'title', type: 'text' },\n        description: { label: 'Descrição', value: 'description', type: 'text' },\n    };\n    Object.values(cards).forEach((card) => {\n        if (card.metadata && typeof card.metadata === 'object') {\n            Object.entries(card.metadata).forEach(([key, value]) => {\n                const path = `metadata.${key}`;\n                if (!fields[path]) {\n                    let type = 'other';\n                    if (typeof value === 'string')\n                        type = 'text';\n                    else if (typeof value === 'number')\n                        type = 'number';\n                    else if (typeof value === 'boolean')\n                        type = 'boolean';\n                    fields[path] = {\n                        label: `${key.charAt(0).toUpperCase() + key.slice(1)} (Meta)`,\n                        value: path,\n                        type,\n                    };\n                }\n            });\n        }\n    });\n    return Object.values(fields);\n}\n","import { jsx as _jsx, jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { Button } from '@/components/ui/button';\nimport { Sheet, SheetContent, SheetDescription, SheetHeader, SheetTitle, SheetTrigger, } from '@/components/ui/sheet';\nimport { useKanbanStore } from '@/lib/store/use-kanban-store';\nimport { Filter, Plus } from 'lucide-react';\nimport { FilterGroup } from './filter-group';\nimport { discoverFields } from '../utils/data-discovery';\nimport { useMemo } from 'react';\nexport function KanbanFilterDrawer() {\n    const { filters, addFilterGroup, cards } = useKanbanStore();\n    const availableFields = useMemo(() => discoverFields(cards), [cards]);\n    const handleAddGroup = () => {\n        const newGroup = {\n            id: crypto.randomUUID(),\n            conjunction: 'and',\n            rules: [],\n            enabled: true\n        };\n        addFilterGroup(newGroup);\n    };\n    return (_jsxs(Sheet, { children: [_jsx(SheetTrigger, { asChild: true, children: _jsxs(Button, { variant: \"outline\", size: \"sm\", className: \"gap-2 text-slate-600 bg-white hover:bg-slate-50 border-slate-200 shadow-sm\", children: [_jsx(Filter, { className: \"h-4 w-4\" }), \"Filtros\", filters.groups.length > 0 && (_jsx(\"span\", { className: \"flex h-5 w-5 items-center justify-center rounded-full bg-primary text-[10px] text-primary-foreground font-bold shadow-sm\", children: filters.groups.length }))] }) }), _jsxs(SheetContent, { className: \"w-full sm:w-[600px] sm:max-w-none overflow-y-auto bg-white/95 backdrop-blur-sm border-l shadow-2xl\", children: [_jsx(SheetHeader, { className: \"pb-6 border-b\", children: _jsxs(\"div\", { className: \"flex items-center justify-between\", children: [_jsxs(\"div\", { children: [_jsx(SheetTitle, { className: \"text-xl font-bold text-slate-800\", children: \"Filtros Avan\\u00E7ados\" }), _jsx(SheetDescription, { className: \"text-sm text-slate-500\", children: \"Crie combina\\u00E7\\u00F5es de filtros para refinar sua visualiza\\u00E7\\u00E3o do board.\" })] }), filters.groups.length > 0 && (_jsx(Button, { variant: \"ghost\", size: \"sm\", onClick: useKanbanStore.getState().clearFilters, className: \"text-xs font-bold text-slate-400 hover:text-destructive h-8\", children: \"Limpar Tudo\" }))] }) }), _jsxs(\"div\", { className: \"mt-8 space-y-6\", children: [filters.groups.length === 0 ? (_jsxs(\"div\", { className: \"text-center py-12 px-6 bg-slate-50/50 border-2 border-dashed border-slate-200 rounded-xl space-y-2\", children: [_jsx(Filter, { className: \"mx-auto h-8 w-8 text-slate-300\" }), _jsx(\"p\", { className: \"text-slate-600 font-medium\", children: \"Nenhum filtro ativo.\" }), _jsx(\"p\", { className: \"text-xs text-slate-400\", children: \"Adicione um grupo para come\\u00E7ar a filtrar seus itens.\" })] })) : (_jsx(\"div\", { className: \"space-y-6\", children: filters.groups.map(group => (_jsx(FilterGroup, { group: group, availableFields: availableFields }, group.id))) })), _jsxs(Button, { onClick: handleAddGroup, className: \"w-full\", variant: \"outline\", children: [_jsx(Plus, { className: \"mr-2 h-4 w-4\" }), \"Adicionar Grupo de Filtros\"] })] })] })] }));\n}\n","import { jsx as _jsx, jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { Button } from \"@/components/ui/button\";\nimport { Dialog, DialogContent, DialogDescription, DialogFooter, DialogHeader, DialogTitle, } from \"@/components/ui/dialog\";\nimport { cn } from '@/lib/utils/cn';\nimport { Plus } from 'lucide-react';\nimport { useState } from 'react';\nexport function DefaultAddCardForm({ columnId: _columnId, onAdd, onCancel }) {\n    const [title, setTitle] = useState('');\n    const [description, setDescription] = useState('');\n    const [priority, setPriority] = useState('medium');\n    const handleSubmit = (e) => {\n        e.preventDefault();\n        onAdd({\n            title,\n            description,\n            metadata: { priority }\n        });\n    };\n    return (_jsx(Dialog, { open: true, onOpenChange: (open) => !open && onCancel(), children: _jsxs(DialogContent, { className: \"sm:max-w-[425px]\", children: [_jsxs(DialogHeader, { children: [_jsx(DialogTitle, { children: \"Adicionar Novo Card\" }), _jsx(DialogDescription, { children: \"Novo item para a coluna.\" })] }), _jsxs(\"form\", { onSubmit: handleSubmit, className: \"grid gap-4 py-4\", children: [_jsxs(\"div\", { className: \"grid gap-2\", children: [_jsx(\"label\", { htmlFor: \"title\", className: \"text-sm font-medium leading-none\", children: \"T\\u00EDtulo\" }), _jsx(\"input\", { id: \"title\", autoFocus: true, value: title, onChange: (e) => setTitle(e.target.value), className: \"flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-sm shadow-sm transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring\", placeholder: \"O que precisa ser feito?\" })] }), _jsxs(\"div\", { className: \"grid gap-2\", children: [_jsx(\"label\", { className: \"text-sm font-medium leading-none\", children: \"Prioridade\" }), _jsx(\"div\", { className: \"flex gap-2\", children: ['low', 'medium', 'high'].map((p) => (_jsx(\"button\", { type: \"button\", onClick: () => setPriority(p), className: cn(\"flex-1 px-3 py-2 text-xs font-bold uppercase tracking-wider rounded-md border transition-all\", priority === p\n                                            ? p === 'high' ? \"bg-red-100 border-red-500 text-red-700\" :\n                                                p === 'medium' ? \"bg-amber-100 border-amber-500 text-amber-900\" :\n                                                    \"bg-emerald-100 border-emerald-500 text-emerald-800\"\n                                            : \"bg-transparent border-slate-200 text-slate-500 hover:bg-slate-50\"), children: p === 'low' ? 'Baixa' : p === 'medium' ? 'Média' : 'Alta' }, p))) })] }), _jsxs(\"div\", { className: \"grid gap-2\", children: [_jsx(\"label\", { htmlFor: \"desc\", className: \"text-sm font-medium leading-none\", children: \"Descri\\u00E7\\u00E3o\" }), _jsx(\"textarea\", { id: \"desc\", value: description, onChange: (e) => setDescription(e.target.value), rows: 3, className: \"flex min-h-[60px] w-full rounded-md border border-input bg-transparent px-3 py-2 text-sm shadow-sm resize-none focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring\", placeholder: \"Detalhes adicionais...\" })] }), _jsxs(DialogFooter, { children: [_jsx(Button, { type: \"button\", variant: \"outline\", onClick: onCancel, children: \"Cancelar\" }), _jsxs(Button, { type: \"submit\", className: \"gap-2 bg-blue-600 hover:bg-blue-700 text-white\", children: [_jsx(Plus, { size: 16 }), \"Criar Card\"] })] })] })] }) }));\n}\n","import { jsx as _jsx, jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { useState } from 'react';\nimport { Save, Trash2 } from 'lucide-react';\nimport { Dialog, DialogContent, DialogDescription, DialogFooter, DialogHeader, DialogTitle, } from \"@/components/ui/dialog\";\nimport { Button } from \"@/components/ui/button\";\nexport function DefaultEditColumnForm({ column, onSave, onCancel, onDelete }) {\n    const [title, setTitle] = useState(column.title || '');\n    const handleSubmit = (e) => {\n        e.preventDefault();\n        onSave({ title });\n    };\n    return (_jsx(Dialog, { open: true, onOpenChange: (open) => !open && onCancel(), children: _jsxs(DialogContent, { className: \"sm:max-w-[400px]\", children: [_jsxs(DialogHeader, { children: [_jsx(DialogTitle, { children: \"Editar Coluna\" }), _jsx(DialogDescription, { children: \"Gerencie as configura\\u00E7\\u00F5es desta coluna.\" })] }), _jsxs(\"form\", { onSubmit: handleSubmit, className: \"grid gap-4 py-4\", children: [_jsxs(\"div\", { className: \"grid gap-2\", children: [_jsx(\"label\", { htmlFor: \"col-title\", className: \"text-sm font-medium leading-none\", children: \"Nome da Coluna\" }), _jsx(\"input\", { id: \"col-title\", autoFocus: true, value: title, onChange: (e) => setTitle(e.target.value), className: \"flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-sm shadow-sm transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring\", placeholder: \"Ex: A Fazer\" })] }), _jsxs(DialogFooter, { className: \"flex items-center justify-between w-full sm:justify-between\", children: [onDelete ? (_jsxs(Button, { type: \"button\", variant: \"destructive\", size: \"sm\", onClick: () => {\n                                        if (window.confirm(\"Tem certeza que deseja excluir esta coluna e mover seus cards para a anterior?\")) {\n                                            onDelete();\n                                        }\n                                    }, className: \"gap-2\", children: [_jsx(Trash2, { size: 14 }), \"Excluir\"] })) : _jsx(\"div\", {}), _jsxs(\"div\", { className: \"flex gap-2\", children: [_jsx(Button, { type: \"button\", variant: \"outline\", onClick: onCancel, children: \"Cancelar\" }), _jsxs(Button, { type: \"submit\", className: \"gap-2\", children: [_jsx(Save, { size: 14 }), \"Salvar\"] })] })] })] })] }) }));\n}\n","import { Fragment as _Fragment, jsx as _jsx, jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { DndContext, DragOverlay, MeasuringStrategy, closestCenter, getFirstCollision, pointerWithin, rectIntersection, useDroppable } from '@dnd-kit/core';\nimport { SortableContext, horizontalListSortingStrategy, useSortable } from '@dnd-kit/sortable';\nimport { useVirtualizer } from '@tanstack/react-virtual';\nimport { Plus } from 'lucide-react';\nimport { cloneElement, isValidElement, memo, useEffect, useMemo, useRef } from 'react';\nimport { cn } from '@/lib/utils/utils';\nimport { useKanban } from '../hooks/use-kanban';\nimport { CSS } from '@dnd-kit/utilities';\nimport { useKanbanDnd } from '../hooks/use-kanban-dnd';\nimport { evaluateFilter } from '../utils/filter-evaluator';\nimport { DefaultCard } from './default/default-card';\nimport { DefaultColumnEmpty } from './default/default-column-empty';\nimport { DefaultColumnHeader } from './default/default-column-header';\nimport { DefaultEditForm } from './default/default-edit-form';\nimport { DefaultCardView } from './default/default-card-view';\nimport { FilterChips } from './filter-chips';\nimport { KanbanColumn } from './kanban-column';\nimport { KanbanFilterDrawer } from './kanban-filter-drawer';\nimport { DefaultAddCardForm } from './default/default-add-card-form';\nimport { DefaultEditColumnForm } from './default/default-edit-column-form';\n// Droppable Wrapper for New Column Button\nconst DroppableNewColumnButton = memo(({ children }) => {\n    const { setNodeRef, isOver } = useDroppable({\n        id: 'new-column-drop-target',\n        data: { type: 'NewColumn' }\n    });\n    return (_jsx(_Fragment, { children: children(isOver, setNodeRef) }));\n});\n// Sortable Wrapper for Virtual Column\nconst SortableVirtualColumn = memo(({ id, start, width, children, allowReorder, cardIds }) => {\n    const { attributes, listeners, setNodeRef, transform, transition, isDragging: isSortableDragging } = useSortable({\n        id,\n        disabled: !allowReorder,\n        data: {\n            type: 'Column',\n            children: cardIds // CRITICAL: Pass card IDs for collision detection\n        }\n    });\n    const style = {\n        position: 'absolute',\n        top: 0,\n        left: `${start}px`, // Virtual positioning via left, NOT transform\n        width: `${width}px`,\n        transition: transition || 'transform 250ms cubic-bezier(0.18, 0.67, 0.6, 1.22)',\n        // Transform is now ONLY for dnd-kit's sorting logic\n        transform: transform && !isSortableDragging\n            ? CSS.Transform.toString(transform)\n            : undefined,\n        zIndex: isSortableDragging ? 50 : undefined,\n        pointerEvents: (isSortableDragging ? 'none' : undefined),\n        animation: isSortableDragging ? 'tilt 0.2s ease-in-out forwards' : undefined,\n    };\n    return (_jsx(\"div\", { ref: setNodeRef, style: style, children: isValidElement(children) ? (cloneElement(children, {\n            dragHandleProps: allowReorder ? { attributes, listeners } : undefined,\n            isDragging: isSortableDragging\n        })) : children }));\n});\nexport function KanboomBoard({ config }) {\n    const kanban = useKanban(config);\n    const parentRef = useRef(null);\n    const columnVirtualizer = useVirtualizer({\n        horizontal: true,\n        count: kanban.columnOrder.length,\n        getScrollElement: () => parentRef.current,\n        estimateSize: () => kanban.config.columnWidth + kanban.config.gap,\n        overscan: 5,\n    });\n    // Filter cards and columns\n    const filteredData = useMemo(() => {\n        const filteredCards = {};\n        // 1. Filter cards\n        Object.values(kanban.cards).forEach((card) => {\n            if (evaluateFilter(card, kanban.filters)) {\n                filteredCards[card.id] = card;\n            }\n        });\n        // 2. Filter card IDs inside columns\n        const filteredColumns = {};\n        Object.values(kanban.columns).forEach(column => {\n            filteredColumns[column.id] = {\n                ...column,\n                cardIds: column.cardIds.filter(id => filteredCards[id])\n            };\n        });\n        return {\n            cards: filteredCards,\n            columns: filteredColumns,\n        };\n    }, [kanban.cards, kanban.columns, kanban.filters]);\n    // Refs for collision detection fallback (from official dnd-kit pattern)\n    const lastOverId = useRef(null);\n    const recentlyMovedToNewContainer = useRef(false);\n    // Reset recentlyMovedToNewContainer after layout settles\n    useEffect(() => {\n        requestAnimationFrame(() => {\n            recentlyMovedToNewContainer.current = false;\n        });\n    }, [kanban.columnOrder, kanban.columns]);\n    const dnd = useKanbanDnd({\n        dragActivationDistance: kanban.config.dragActivationDistance,\n        touchActivationDelay: kanban.config.touchActivationDelay,\n        onDragStart: (id, _type) => {\n            kanban.handleDragStart(id);\n        },\n        onDragOver: kanban.handleDragOver,\n        onDragEnd: kanban.handleDragEnd,\n        onCardMove: kanban.moveCard,\n        onColumnMove: kanban.moveColumn,\n        onCreateColumnWithCard: (cardId, sourceColumnId) => {\n            kanban.addColumnWithCard(cardId, sourceColumnId, { title: 'Nova Coluna' });\n        },\n        columns: kanban.columns,\n        columnOrder: kanban.columnOrder,\n        recentlyMovedToNewContainer\n    });\n    const activeCard = kanban.activeId && kanban.cards[kanban.activeId] ? kanban.cards[kanban.activeId] : null;\n    const activeColumn = kanban.activeId && kanban.columnOrder.includes(kanban.activeId) ? kanban.columns[kanban.activeId] : null;\n    const viewingCard = kanban.viewingCardId ? kanban.cards[kanban.viewingCardId] : null;\n    const editingColumn = kanban.editingColumnId ? kanban.columns[kanban.editingColumnId] : null;\n    const finalConfig = {\n        renderCard: config?.renderCard ?? ((props) => _jsx(DefaultCard, { ...props })),\n        renderColumnHeader: config?.renderColumnHeader ?? ((props) => _jsx(DefaultColumnHeader, { ...props })),\n        renderColumnEmpty: config?.renderColumnEmpty ?? (() => _jsx(DefaultColumnEmpty, {})),\n        renderAddButton: config?.renderAddButton,\n        renderAddForm: config?.renderAddForm,\n        renderEditForm: config?.renderEditForm,\n        renderAddColumnButton: config?.renderAddColumnButton,\n        renderAddColumnForm: config?.renderAddColumnForm,\n        renderEditColumnForm: config?.renderEditColumnForm,\n        estimatedCardHeight: kanban.config.estimatedCardHeight,\n        virtualOverscan: kanban.config.virtualOverscan,\n        columnWidth: kanban.config.columnWidth,\n        columnMinHeight: kanban.config.columnMinHeight,\n        onCardClick: config?.onCardClick ?? ((card) => kanban.setViewingCardId(card.id)),\n        onColumnClick: config?.onColumnClick,\n        onEdit: kanban.config.allowEdit ? kanban.setEditingCardId : undefined,\n        onEditColumn: (column) => kanban.setEditingColumnId(column.id),\n        renderCardView: config?.renderCardView,\n        allowAdd: kanban.config.allowAdd,\n        allowColumnAdd: kanban.config.allowColumnAdd,\n        allowColumnEdit: kanban.config.allowColumnEdit,\n        allowColumnDelete: kanban.config.allowColumnDelete,\n        allowColumnReorder: kanban.config.allowColumnReorder,\n        allowFilters: kanban.config.allowFilters,\n    };\n    /**\n     * Custom collision detection strategy optimized for multiple containers\n     * Based on official dnd-kit MultipleContainers example\n     */\n    const customCollisionDetection = (args) => {\n        const activeId = args.active.id;\n        const isDraggingCard = activeId && !kanban.columnOrder.includes(activeId);\n        // If dragging a column, use closestCenter (snappier for horizontal reordering)\n        if (!isDraggingCard) {\n            return closestCenter(args);\n        }\n        // 1. Explicit check for New Column target - HIGH PRIORITY\n        const pointerCollisions = pointerWithin(args);\n        if (activeId && pointerCollisions.length > 0) {\n            const newColumnCollision = pointerCollisions.find(c => c.id === 'new-column-drop-target');\n            if (newColumnCollision) {\n                return [newColumnCollision];\n            }\n        }\n        // 2. Dragging a card - use multi-container strategy\n        // Find intersecting containers with the active draggable rect\n        const intersections = pointerCollisions.length > 0\n            ? pointerCollisions\n            : rectIntersection(args);\n        let overId = getFirstCollision(intersections, 'id');\n        if (overId != null) {\n            // If we found a container (column), get the closest item within it\n            if (kanban.columnOrder.includes(overId)) {\n                const column = kanban.columns[overId];\n                if (column && column.cardIds.length > 0) {\n                    // Return the closest droppable within that container\n                    const containerItems = args.droppableContainers.filter((container) => container.id !== overId && column.cardIds.includes(container.id));\n                    if (containerItems.length > 0) {\n                        const closest = closestCenter({\n                            ...args,\n                            droppableContainers: containerItems,\n                        });\n                        overId = closest[0]?.id ?? overId;\n                    }\n                }\n            }\n            lastOverId.current = overId;\n            return [{ id: overId }];\n        }\n        // 4. Fallback to normal collision detection\n        const collisions = closestCenter({\n            ...args,\n            droppableContainers: args.droppableContainers.filter((container) => container.id !== activeId)\n        });\n        if (collisions.length > 0) {\n            lastOverId.current = collisions[0].id;\n            return collisions;\n        }\n        if (recentlyMovedToNewContainer.current) {\n            lastOverId.current = activeId;\n        }\n        // If no droppable is matched, return the last match\n        return lastOverId.current ? [{ id: lastOverId.current }] : [];\n    };\n    return (_jsx(DndContext, { sensors: dnd.sensors, collisionDetection: customCollisionDetection, measuring: {\n            droppable: {\n                strategy: MeasuringStrategy.Always,\n            },\n        }, onDragStart: dnd.handleDragStart, onDragOver: dnd.handleDragOver, onDragEnd: dnd.handleDragEnd, children: _jsxs(\"div\", { className: \"flex flex-col h-full bg-slate-50 relative group/board overflow-hidden\", children: [kanban.config.allowFilters && (_jsx(\"div\", { className: \"absolute top-4 right-6 z-30 pointer-events-none\", children: _jsx(\"div\", { className: \"pointer-events-auto transition-all duration-300 translate-y-[-10px] opacity-0 group-hover/board:translate-y-0 group-hover/board:opacity-100\", children: _jsx(KanbanFilterDrawer, {}) }) })), kanban.config.allowFilters && _jsx(FilterChips, {}), _jsx(\"div\", { ref: parentRef, className: \"flex-1 overflow-x-auto overflow-y-hidden\", children: _jsxs(\"div\", { style: {\n                            width: `${columnVirtualizer.getTotalSize() + (kanban.config.allowColumnAdd ? 200 : 0)}px`,\n                            height: '100%',\n                            position: 'relative',\n                        }, children: [_jsx(SortableContext, { items: kanban.columnOrder, strategy: horizontalListSortingStrategy, children: columnVirtualizer.getVirtualItems().map((virtualColumn) => {\n                                    const columnId = kanban.columnOrder[virtualColumn.index];\n                                    return (_jsx(SortableVirtualColumn, { id: columnId, start: virtualColumn.start, width: kanban.config.columnWidth, allowReorder: kanban.config.allowColumnReorder, cardIds: filteredData.columns[columnId]?.cardIds ?? [], children: _jsx(KanbanColumn, { column: filteredData.columns[columnId], allCards: filteredData.cards, activeId: kanban.activeId, overId: kanban.overId, overSide: kanban.overSide, config: finalConfig, isActiveColumnDragging: kanban.activeId ? kanban.columnOrder.includes(kanban.activeId) : false }) }, columnId));\n                                }) }), kanban.config.allowColumnAdd && (_jsx(DroppableNewColumnButton, { children: (isOver, setNodeRef) => (_jsx(\"div\", { ref: setNodeRef, className: \"h-full z-10\", style: {\n                                        position: 'absolute',\n                                        top: 0,\n                                        left: `${columnVirtualizer.getTotalSize()}px`,\n                                        width: kanban.config.columnWidth,\n                                        height: '100%',\n                                        boxSizing: 'border-box',\n                                        paddingRight: kanban.config.gap\n                                    }, children: config?.renderAddColumnButton ? (config.renderAddColumnButton({ onClick: () => kanban.addColumn({ title: 'Nova Coluna' }) })) : (_jsxs(\"button\", { onClick: () => kanban.addColumn({ title: 'Nova Coluna' }), className: cn(\"flex items-center gap-2 w-full p-4 bg-slate-100/50 hover:bg-slate-200 text-slate-600 rounded-lg border-2 border-dashed transition-all font-semibold h-[200px] justify-center\", isOver ? \"bg-blue-100 border-blue-400 text-blue-600 scale-[1.02] shadow-lg ring-4 ring-blue-500/20\" : \"border-slate-300\"), children: [_jsx(Plus, { size: 20 }), isOver ? 'Soltar para criar' : 'Nova Coluna'] })) })) }))] }) }), kanban.editingCardId && kanban.config.allowEdit && ((() => {\n                    const editingCard = kanban.cards[kanban.editingCardId];\n                    if (!editingCard)\n                        return null;\n                    return config?.renderEditForm ? (config.renderEditForm({\n                        card: editingCard,\n                        onSave: (updates) => {\n                            kanban.updateCard(kanban.editingCardId, updates);\n                            kanban.clearEditingCardId();\n                        },\n                        onCancel: kanban.clearEditingCardId,\n                        onDelete: () => {\n                            kanban.deleteCard(kanban.editingCardId);\n                            kanban.clearEditingCardId();\n                        }\n                    })) : (_jsx(DefaultEditForm, { card: editingCard, onSave: (updates) => {\n                            kanban.updateCard(kanban.editingCardId, updates);\n                            kanban.clearEditingCardId();\n                        }, onCancel: kanban.clearEditingCardId, onDelete: () => {\n                            kanban.deleteCard(kanban.editingCardId);\n                            kanban.clearEditingCardId();\n                        } }));\n                })()), kanban.addingCardInColumnId && kanban.config.allowAdd && (config?.renderAddForm ? (config.renderAddForm({\n                    columnId: kanban.addingCardInColumnId,\n                    onAdd: (data) => {\n                        kanban.addCard(kanban.addingCardInColumnId, data);\n                        kanban.clearAddingCardInColumnId();\n                    },\n                    onCancel: kanban.clearAddingCardInColumnId\n                })) : (_jsx(DefaultAddCardForm, { columnId: kanban.addingCardInColumnId, onAdd: (data) => {\n                        kanban.addCard(kanban.addingCardInColumnId, data);\n                        kanban.clearAddingCardInColumnId();\n                    }, onCancel: kanban.clearAddingCardInColumnId }))), editingColumn && kanban.config.allowColumnEdit && (config?.renderEditColumnForm ? (config.renderEditColumnForm({\n                    column: editingColumn,\n                    onSave: (updates) => {\n                        kanban.updateColumn(editingColumn.id, updates);\n                        kanban.clearEditingColumnId();\n                    },\n                    onCancel: kanban.clearEditingColumnId,\n                    onDelete: kanban.config.allowColumnDelete ? () => {\n                        kanban.deleteColumn(editingColumn.id);\n                        kanban.clearEditingColumnId();\n                    } : undefined\n                })) : (_jsx(DefaultEditColumnForm, { column: editingColumn, onSave: (updates) => {\n                        kanban.updateColumn(editingColumn.id, updates);\n                        kanban.clearEditingColumnId();\n                    }, onCancel: kanban.clearEditingColumnId, onDelete: kanban.config.allowColumnDelete ? () => {\n                        kanban.deleteColumn(editingColumn.id);\n                        kanban.clearEditingColumnId();\n                    } : undefined }))), viewingCard && (finalConfig.renderCardView ? (finalConfig.renderCardView({\n                    card: viewingCard,\n                    onClose: kanban.clearViewingCardId\n                })) : (_jsx(DefaultCardView, { card: viewingCard, onClose: kanban.clearViewingCardId }))), _jsxs(DragOverlay, { dropAnimation: null, children: [activeCard && (_jsx(\"div\", { className: \"z-50 cursor-grabbing animate-tilt shadow-2xl rounded-card overflow-hidden\", children: finalConfig.renderCard({\n                                card: activeCard,\n                                isDragging: true\n                            }) })), activeColumn ? (_jsx(KanbanColumn, { column: activeColumn, allCards: kanban.cards, activeId: null, overId: null, overSide: null, config: finalConfig, isDragging: false, isOverlay: true, dragHandleProps: {\n                                attributes: {},\n                                listeners: {}\n                            } })) : null] })] }) }));\n}\n","/**\n * Zustand selectors for optimized component subscriptions\n * Components should use these instead of subscribing to the entire store\n */\n// === CARD SELECTORS ===\nexport const selectCard = (cardId) => (state) => state.cards[cardId];\nexport const selectAllCards = (state) => state.cards;\nexport const selectCardsByIds = (cardIds) => (state) => cardIds.map(id => state.cards[id]).filter(Boolean);\n// === COLUMN SELECTORS ===\nexport const selectColumn = (columnId) => (state) => state.columns[columnId];\nexport const selectAllColumns = (state) => state.columns;\nexport const selectColumnOrder = (state) => state.columnOrder;\nexport const selectColumnCards = (columnId) => (state) => {\n    const column = state.columns[columnId];\n    if (!column)\n        return [];\n    return column.cardIds.map(id => state.cards[id]).filter(Boolean);\n};\nexport const selectColumnCardIds = (columnId) => (state) => {\n    const column = state.columns[columnId];\n    return column?.cardIds || [];\n};\n// === ACTIONS SELECTORS ===\n// Note: CRUD actions will be added in future implementation\nexport const selectMoveCard = (state) => state.moveCard;\nexport const selectMoveColumn = (state) => state.moveColumn;\nexport const selectSetBoardData = (state) => state.setBoardData;\n// === UTILITY SELECTORS ===\nexport const selectBoardData = (state) => ({\n    cards: state.cards,\n    columns: state.columns,\n    columnOrder: state.columnOrder,\n});\nexport const selectCardCount = (state) => Object.keys(state.cards).length;\nexport const selectColumnCount = (state) => state.columnOrder.length;\n","import { jsx as _jsx, jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { useEffect, useState, useRef } from 'react';\nexport const useFPS = () => {\n    const [fps, setFps] = useState(0);\n    const frameCount = useRef(0);\n    const lastTime = useRef(performance.now());\n    useEffect(() => {\n        let animationFrameId;\n        const measure = (time) => {\n            frameCount.current++;\n            const delta = time - lastTime.current;\n            if (delta >= 1000) {\n                setFps(Math.round((frameCount.current * 1000) / delta));\n                frameCount.current = 0;\n                lastTime.current = time;\n            }\n            animationFrameId = requestAnimationFrame(measure);\n        };\n        animationFrameId = requestAnimationFrame(measure);\n        return () => {\n            cancelAnimationFrame(animationFrameId);\n        };\n    }, []);\n    return fps;\n};\nexport const BenchmarkStats = ({ cardCount, columnCount }) => {\n    const fps = useFPS();\n    const [minFps, setMinFps] = useState(60);\n    const [maxFps, setMaxFps] = useState(0);\n    const [isStressTesting, setIsStressTesting] = useState(false);\n    useEffect(() => {\n        if (fps > 0) {\n            if (fps < minFps)\n                setMinFps(fps);\n            if (fps > maxFps)\n                setMaxFps(fps);\n        }\n    }, [fps]);\n    useEffect(() => {\n        if (!isStressTesting)\n            return;\n        const columns = document.querySelectorAll('.overflow-y-auto');\n        let direction = 1;\n        let speed = 2;\n        let animationId;\n        const autoScroll = () => {\n            columns.forEach(col => {\n                col.scrollTop += speed * direction;\n                if (col.scrollTop >= col.scrollHeight - col.clientHeight)\n                    direction = -1;\n                if (col.scrollTop <= 0)\n                    direction = 1;\n            });\n            animationId = requestAnimationFrame(autoScroll);\n        };\n        animationId = requestAnimationFrame(autoScroll);\n        return () => cancelAnimationFrame(animationId);\n    }, [isStressTesting]);\n    return (_jsxs(\"div\", { className: \"fixed bottom-4 right-4 bg-slate-900/90 text-white p-4 rounded-lg shadow-lg backdrop-blur-sm z-50 font-mono text-sm\", children: [_jsxs(\"div\", { className: \"flex items-center justify-between mb-2 gap-2\", children: [_jsx(\"h3\", { className: \"font-bold text-blue-400\", children: \"\\u26A1 Performance Stats\" }), _jsx(\"button\", { onClick: () => setIsStressTesting(!isStressTesting), className: `text-xs px-2 py-1 rounded ${isStressTesting ? 'bg-red-500 hover:bg-red-600' : 'bg-blue-600 hover:bg-blue-700'}`, children: isStressTesting ? 'Stop Stress Test' : 'Start Stress Test' })] }), _jsxs(\"div\", { className: \"grid grid-cols-2 gap-x-4 gap-y-1\", children: [_jsx(\"span\", { className: \"text-slate-400\", children: \"FPS:\" }), _jsx(\"span\", { className: `font-bold ${fps < 30 ? 'text-red-400' : fps < 50 ? 'text-yellow-400' : 'text-green-400'}`, children: fps }), _jsx(\"span\", { className: \"text-slate-400\", children: \"Min FPS:\" }), _jsx(\"span\", { className: \"text-slate-200\", children: minFps }), _jsx(\"span\", { className: \"text-slate-400\", children: \"Cards:\" }), _jsx(\"span\", { className: \"text-slate-200\", children: cardCount }), _jsx(\"span\", { className: \"text-slate-400\", children: \"Columns:\" }), _jsx(\"span\", { className: \"text-slate-200\", children: columnCount })] })] }));\n};\n"],"names":["cn","inputs","twMerge","clsx","generateId","useKanbanStore","create","devtools","set","columnId","cardData","cardId","newCard","state","column","updates","card","deletedCard","remainingCards","updatedColumns","colId","id","newCardId","duplicatedCard","cardIndex","newCardIds","columnData","position","newColumn","newColumnOrder","insertPosition","moveCardsTo","deletedColumn","remainingColumns","updatedCards","targetCol","firstColumnId","targetColId","sourceColId","newIndex","sourceCol","newSourceCardIds","newTargetCardIds","updatedCard","newOrder","query","group","groupId","g","ruleId","r","filters","data","config","activeId","viewingCardId","editingCardId","addingCardInColumnId","editingColumnId","useKanban","store","setActiveId","useState","overId","setOverId","overSide","setOverSide","handleDragStart","useCallback","handleDragOver","side","handleDragEnd","moveCard","sourceColumnId","targetColumnId","index","useKanbanDnd","dragActivationDistance","touchActivationDelay","onDragStart","onDragOver","onDragEnd","onCardMove","onColumnMove","onCreateColumnWithCard","columns","columnOrder","recentlyMovedToNewContainer","columnsRef","useRef","columnOrderRef","useEffect","dragPositionRef","useSensors","useSensor","MouseSensor","TouchSensor","KeyboardSensor","event","type","active","over","currentColumns","currentOrder","overRect","activeRect","overCenterX","overCenterY","overCol","col","overIndex","currentIndex","activeColumn","overColumn","finalIndex","pos","evaluateFilter","titleMatch","descMatch","metadataMatch","val","evaluateGroup","conjunction","rules","rule","evaluateRule","value","getNestedValue","target","obj","path","acc","part","DefaultCard","memo","isDragging","tags","members","commentsCount","attachmentsCount","dueDate","priority","priorityColors","_jsxs","_jsx","tag","i","MoreHorizontal","m","Calendar","MessageSquare","Paperclip","prevProps","nextProps","DefaultColumnEmpty","DefaultColumnHeader","cardCount","isOver","dragHandleProps","onAddCard","onEditColumn","e","GripVertical","Plus","Dialog","DialogPrimitive","DialogPortal","DialogOverlay","React","className","props","ref","DialogContent","children","X","DialogHeader","DialogFooter","DialogTitle","DialogDescription","buttonVariants","cva","Button","variant","size","asChild","Slot","DefaultEditForm","onSave","onCancel","onDelete","title","setTitle","description","setDescription","handleSubmit","open","Trash2","Save","DefaultCardView","onClose","otherMetadata","pConfig","AlignLeft","User","Tag","Info","key","FilterChips","removeFilterRule","clearFilters","activeRules","RotateCcw","heightCache","useKanbanColumn","cardIds","estimatedCardHeight","baseOverscan","parentRef","scrollVelocity","setScrollVelocity","element","lastScrollTop","lastTime","rafId","handleScroll","now","scrollTop","deltaTime","deltaScroll","velocity","throttledScroll","dynamicOverscan","useMemo","rowVirtualizer","useVirtualizer","cached","height","AddCardButton","onClick","KanbanCardInner","renderCard","onEdit","allowEdit","attributes","listeners","setNodeRef","transform","transition","isSortableDragging","useSortable","style","CSS","handleClick","cardContent","KanbanCard","KanbanColumnInner","allCards","isActiveColumnDragging","isOverlay","setAddingCardInColumnId","setEditingColumnId","isColumnOver","SortableContext","verticalListSortingStrategy","virtualRow","isActive","KanbanColumn","Sheet","SheetPrimitive","SheetTrigger","SheetPortal","SheetOverlay","sheetVariants","SheetContent","SheetHeader","SheetTitle","SheetDescription","FilterGroup","availableFields","updateFilterGroup","removeFilterGroup","handleAddRule","newRule","handleRemoveRule","handleUpdateRule","FilterRuleRow","onUpdate","operators","f","o","discoverFields","cards","fields","KanbanFilterDrawer","addFilterGroup","handleAddGroup","newGroup","Filter","DefaultAddCardForm","_columnId","onAdd","setPriority","p","DefaultEditColumnForm","DroppableNewColumnButton","useDroppable","_Fragment","SortableVirtualColumn","start","width","allowReorder","isValidElement","cloneElement","KanboomBoard","kanban","columnVirtualizer","filteredData","filteredCards","filteredColumns","lastOverId","dnd","_type","activeCard","viewingCard","editingColumn","finalConfig","customCollisionDetection","args","closestCenter","pointerCollisions","pointerWithin","newColumnCollision","c","intersections","rectIntersection","getFirstCollision","containerItems","container","collisions","DndContext","MeasuringStrategy","horizontalListSortingStrategy","virtualColumn","editingCard","DragOverlay","selectCard","selectAllCards","selectCardsByIds","selectColumn","selectAllColumns","selectColumnOrder","selectColumnCards","selectColumnCardIds","selectMoveCard","selectMoveColumn","selectSetBoardData","selectBoardData","selectCardCount","selectColumnCount","useFPS","fps","setFps","frameCount","animationFrameId","measure","time","delta","BenchmarkStats","columnCount","minFps","setMinFps","maxFps","setMaxFps","isStressTesting","setIsStressTesting","direction","speed","animationId","autoScroll"],"mappings":"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"}